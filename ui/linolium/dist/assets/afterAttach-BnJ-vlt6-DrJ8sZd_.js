import{i as o,u as r,t as c}from"./JBrowsePanel-CjeUdi3D-Dhrr89W5.js";import"./index-Bwk-R6QR.js";import"./taxonium-component.es-D8UFPkMd.js";async function g(e){const t=c.getRpcSessionId(e),{rpcManager:s}=r.getSession(e),a=r.getContainingView(e);if(!a.initialized||e.error||!e.statsReadyAndRegionNotTooLarge)return;e.setLoading(!0);const n=await s.call(t,"PileupGetReducedFeatures",{sessionId:t,regions:a.staticBlocks.contentBlocks,filterBy:e.filterBy,adapterConfig:e.adapterConfig});e.setChainData(n),e.setLoading(!1)}function p(e,t){o(e,async()=>{await g(e)},{delay:1e3});function s(a){const n=e.ref;if(!n)return;const i=n.getContext("2d");i&&e.chainData&&(i.clearRect(0,0,n.width,e.height*2),i.resetTransform(),i.scale(2,2),t(e,i,n.width,e.height),e.setLastDrawnOffsetPx(a.offsetPx),e.setLastDrawnBpPerPx(a.bpPerPx))}o(e,async()=>{const a=r.getContainingView(e);a.bpPerPx!==e.lastDrawnBpPerPx&&s(a)}),o(e,async()=>{const a=r.getContainingView(e);s(a)},{delay:1e3})}export{p as doAfterAttach};
