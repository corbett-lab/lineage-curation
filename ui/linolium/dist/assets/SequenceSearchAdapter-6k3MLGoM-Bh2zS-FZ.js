import{e as $}from"./index-Bp4pXTEU-Cipcrd2k.js";import{$ as A,a0 as C,u as n}from"./JBrowsePanel-CjeUdi3D-Dhrr89W5.js";import{o as F}from"./rxjs-euq-mp90-DvajfGj-.js";import"./index-Bwk-R6QR.js";import"./taxonium-component.es-D8UFPkMd.js";class E extends $.BaseFeatureDataAdapter{async configure(){var e;const i=await((e=this.getSubAdapter)===null||e===void 0?void 0:e.call(this,this.getConf("sequenceAdapter")));if(!i)throw new Error("Error getting subadapter");return i.dataAdapter}async getRefNames(){return(await this.configure()).getRefNames()}getFeatures(e,i){return F.ObservableCreate(async o=>{var f;const l=await this.configure(),m=1e4,s=e.end+m,d=Math.max(0,e.start-m);if(s<0||d>s){o.complete();return}const p=l.getFeatures({...e,start:d,end:s},i),g=((f=(await A(p.pipe(C())))[0])===null||f===void 0?void 0:f.get("seq"))||"",u=this.getConf("search"),w=this.getConf("searchForward"),x=this.getConf("searchReverse"),v=this.getConf("caseInsensitive"),h=new RegExp(u,`g${v?"i":""}`);if(u){if(w){const c=g.matchAll(h);for(const t of c){const a=d+t.index,r=d+t.index+t[0].length;n.doesIntersect2(a,r,e.start,e.end)&&o.next(new n.SimpleFeature({uniqueId:`${this.id}-${a}-${t[0]}-pos`,refName:e.refName,start:a,end:r,name:t[0],strand:1}))}}if(x){const c=n.revcom(g).matchAll(h);for(const t of c){const a=s-t.index,r=s-t.index-t[0].length;n.doesIntersect2(r,a,e.start,e.end)&&o.next(new n.SimpleFeature({uniqueId:`${this.id}-${r}-${t[0]}-neg`,refName:e.refName,start:r,end:a,name:t[0],strand:-1}))}}}o.complete()})}}export{E as default};
