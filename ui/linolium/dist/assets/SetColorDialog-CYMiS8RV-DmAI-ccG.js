import{r as m,j as e}from"./index-Bwk-R6QR.js";import{x as N}from"./DraggableDialog-CDUQSgiK-DXKKLHfz.js";import{m as S,u as h,D as O,B as r,d as R,ap as T,aq as Y,ar as L,as as W,a as E}from"./JBrowsePanel-CjeUdi3D-Dhrr89W5.js";import{t as $,c as q}from"./ColorPicker-DfV0rLc1-CT4FsxiE.js";import{x as w,m as b}from"./util-B0sEnOgw-Ca3d5OPC.js";import{H as z}from"./DataGrid-CtzhbUAR-B5avypAp.js";import"./taxonium-component.es-D8UFPkMd.js";import"./getThemeProps-VQY9obTE-DyGMZP3D.js";import"./FormControlLabel-t1db3bCW-BhUWxcLA.js";import"./MenuItem-bcu4bG3--CNW0nWZm.js";import"./dividerClasses-CVTzPOoo-DLNaoCl0.js";import"./Divider-DzCbFD9M-BaKdmFVz.js";import"./Badge-DesLZhxI-BI0lVxgb.js";import"./TableCell-mfS6Ut2J-N_4-_qc3.js";import"./Checkbox-DRfuV2d3-Bnouab3n.js";const B=S()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}});function D({rows:l,onChange:t,showTips:a}){const{classes:x}=B(),[u,d]=m.useState(null),[s,p]=m.useState([]),{name:F,color:J,baseUri:K,...k}=l[0],[v,M]=m.useState("blue"),[j,H]=m.useState({idx:0,field:null});return e.jsxs("div",{children:[e.jsx(r,{disabled:!s.length,onClick:o=>{d(o.currentTarget)},children:"Change color of selected items"}),e.jsxs(r,{disabled:!s.length,onClick:()=>{t(w([...l],s))},children:[e.jsx(T,{}),a?"Move selected items up":null]}),e.jsxs(r,{disabled:!s.length,onClick:()=>{t(b([...l],s))},children:[e.jsx(Y,{}),a?"Move selected items down":null]}),e.jsxs(r,{disabled:!s.length,onClick:()=>{t(w([...l],s,l.length))},children:[e.jsx(L,{}),a?"Move selected items to top":null]}),e.jsxs(r,{disabled:!s.length,onClick:()=>{t(b([...l],s,l.length))},children:[e.jsx(W,{}),a?"Move selected items to bottom":null]}),e.jsx($.ColorPopover,{anchorEl:u,color:v,onChange:o=>{M(o);for(const n of s){const c=l.find(i=>i.name===n);c&&(c.color=o)}t([...l])},onClose:()=>{d(null)}}),e.jsx("div",{style:{height:400,width:"100%"},children:e.jsx(z,{disableRowSelectionOnClick:!0,getRowId:o=>o.name,checkboxSelection:!0,onRowSelectionModelChange:o=>{p([...o.ids])},rows:l,rowHeight:25,columnHeaderHeight:33,columns:[{field:"color",headerName:"Color",renderCell:({value:o,id:n})=>e.jsx(q,{color:o||"blue",onChange:c=>{const i=l.find(g=>g.name===n);i&&(i.color=c),t([...l])}})},{field:"name",headerName:"Name",width:h.measureGridWidth(l.map(o=>o.name))},...Object.keys(k).map(o=>({field:o,renderCell:({value:n})=>e.jsx("div",{className:x.cell,children:e.jsx(E.SanitizedHTML,{html:h.getStr(n)})}),width:h.measureGridWidth(l.map(n=>`${n[o]}`))}))],sortModel:[],onSortModelChange:o=>{const n=o[0],c=(j.idx+1)%2,i=n.field||j.field;H({idx:c,field:i}),t(i?[...l].sort((g,y)=>{const f=h.getStr(g[i]),C=h.getStr(y[i]);return c===1?f.localeCompare(C):C.localeCompare(f)}):l)}})})]})}const G=S()({content:{minWidth:800},float:{float:"right"}});function I(){return e.jsxs(e.Fragment,{children:["Helpful tips",e.jsxs("ul",{children:[e.jsx("li",{children:"You can select rows in the table with the checkboxes"}),e.jsx("li",{children:"Multi-select is enabled with shift-click and control-click"}),e.jsx("li",{children:'The "Move selected items up/down" can re-arrange subtracks'}),e.jsx("li",{children:"Sorting the data grid itself can also re-arrange subtracks"}),e.jsx("li",{children:"Changes are applied when you hit Submit"}),e.jsx("li",{children:"You can click and drag the dialog box to move it on the screen"}),e.jsx("li",{children:"Columns in the table can be hidden using a vertical '...' menu on the right side of each column"})]})]})}function re({model:l,handleClose:t}){const{classes:a}=G(),{sources:x}=l,[u,d]=m.useState(structuredClone(x||[])),[s,p]=h.useLocalStorage("multiwiggle-showTips",!1);return e.jsxs(N,{open:!0,onClose:t,maxWidth:"xl",title:"Multi-wiggle color/arrangement editor",children:[e.jsxs(O,{className:a.content,children:[e.jsx(r,{variant:"contained",className:a.float,onClick:()=>{p(!s)},children:s?"Hide tips":"Show tips"}),e.jsx("br",{}),s?e.jsx(I,{}):null,e.jsx(D,{rows:u,onChange:d,showTips:s})]}),e.jsxs(R,{children:[e.jsx(r,{variant:"contained",type:"submit",color:"inherit",onClick:()=>{l.clearLayout(),d(l.sources||[])},children:"Clear custom settings"}),e.jsx(r,{variant:"contained",color:"secondary",onClick:()=>{t(),d([...l.sources||[]])},children:"Cancel"}),e.jsx(r,{variant:"contained",color:"primary",type:"submit",onClick:()=>{l.setLayout(u),t()},children:"Submit"})]})]})}export{re as default};
