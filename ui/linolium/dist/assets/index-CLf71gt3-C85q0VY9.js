import{r,j as e}from"./index-Bwk-R6QR.js";import{o as d,a as c,m as k,D as b,aV as I,d as F,B as u,c as y,a4 as C,U as H,s as j,bp as N,bo as U}from"./JBrowsePanel-CjeUdi3D-Dhrr89W5.js";import{J as O}from"./MenuItem-bcu4bG3--CNW0nWZm.js";import{i as $}from"./DataGridFlexContainer-BKpGzTb2-BNeUWItU.js";import{r as E}from"./Delete-DSU0jSiU-1j-ZpVRl.js";import{H as J}from"./DataGrid-CtzhbUAR-B5avypAp.js";import"./taxonium-component.es-D8UFPkMd.js";import"./dividerClasses-CVTzPOoo-DLNaoCl0.js";import"./getThemeProps-VQY9obTE-DyGMZP3D.js";import"./FormControlLabel-t1db3bCW-BhUWxcLA.js";import"./Divider-DzCbFD9M-BaKdmFVz.js";import"./Badge-DesLZhxI-BI0lVxgb.js";import"./TableCell-mfS6Ut2J-N_4-_qc3.js";import"./Checkbox-DRfuV2d3-Bnouab3n.js";const R=d(function({adapterSelection:s,setAdapterSelection:n,adapterTypes:o}){return e.jsx(y,{value:s,variant:"outlined",select:!0,helperText:"Type of adapter to use",fullWidth:!0,onChange:a=>{n(a.target.value)},children:o.map(a=>e.jsx(O,{value:a,children:a},a))})}),q=d(function({fastaLocation:s,setFastaLocation:n}){return e.jsxs(e.Fragment,{children:[e.jsx(U,{severity:"warning",style:{margin:30},children:"Note: use only relatively small files for this type, it is loaded into memory"}),e.jsx("div",{children:e.jsx(c.FileSelector,{inline:!0,name:"fastaLocation",location:s,setLocation:o=>{n(o)}})})]})}),D=d(function({fastaLocation:s,faiLocation:n,setFaiLocation:o,setFastaLocation:a}){return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx(c.FileSelector,{inline:!0,name:"fastaLocation",location:s,setLocation:t=>{a(t)}})}),e.jsx("div",{children:e.jsx(c.FileSelector,{inline:!0,name:"faiLocation",location:n,setLocation:t=>{o(t)}})})]})}),M=d(function({fastaLocation:s,faiLocation:n,gziLocation:o,setFaiLocation:a,setGziLocation:t,setFastaLocation:l}){return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx(c.FileSelector,{inline:!0,name:"fastaLocation",location:s,setLocation:i=>{l(i)}})}),e.jsx("div",{children:e.jsx(c.FileSelector,{inline:!0,name:"faiLocation",location:n,setLocation:i=>{a(i)}})}),e.jsx("div",{children:e.jsx(c.FileSelector,{inline:!0,name:"gziLocation",location:o,setLocation:i=>{t(i)}})})]})}),P=d(function({twoBitLocation:s,chromSizesLocation:n,setTwoBitLocation:o,setChromSizesLocation:a}){return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx(c.FileSelector,{inline:!0,name:"twoBitLocation",location:s,setLocation:t=>{o(t)}})}),e.jsx("div",{children:e.jsx(c.FileSelector,{inline:!0,name:"chromSizesLocation (optional, can be added to speed up loading 2bit files with many contigs)",location:n,setLocation:t=>{a(t)}})})]})}),p={uri:""},w=["IndexedFastaAdapter","BgzipFastaAdapter","UnindexedFastaAdapter","TwoBitAdapter"],V=d(function({session:s,onClose:n}){const[o,a]=r.useState(""),[t,l]=r.useState(""),[i,x]=r.useState(w[0]),[m,f]=r.useState(p),[h,g]=r.useState(p),[A,z]=r.useState(p),[v,B]=r.useState(p),[S,T]=r.useState(p);return e.jsxs(e.Fragment,{children:[e.jsxs(b,{children:[e.jsx(y,{id:"assembly-name",label:"Assembly name",helperText:"The assembly name e.g. hg38",variant:"outlined",value:o,onChange:L=>{a(L.target.value)},slotProps:{htmlInput:{"data-testid":"assembly-name"}}}),e.jsx(y,{id:"assembly-name",label:"Assembly display name",helperText:'(optional) A human readable display name for the assembly e.g. "Homo sapiens (hg38)"',variant:"outlined",value:t,onChange:L=>{l(L.target.value)},slotProps:{htmlInput:{"data-testid":"assembly-display-name"}}}),e.jsx(R,{adapterSelection:i,adapterTypes:w,setAdapterSelection:x}),i==="IndexedFastaAdapter"?e.jsx(D,{fastaLocation:m,faiLocation:h,setFaiLocation:g,setFastaLocation:f}):i==="UnindexedFastaAdapter"?e.jsx(q,{fastaLocation:m,setFastaLocation:f}):i==="TwoBitAdapter"?e.jsx(P,{twoBitLocation:v,chromSizesLocation:S,setTwoBitLocation:B,setChromSizesLocation:T}):e.jsx(M,{fastaLocation:m,gziLocation:A,faiLocation:h,setFaiLocation:g,setGziLocation:z,setFastaLocation:f})]}),e.jsxs(F,{children:[e.jsx(u,{variant:"contained",color:"primary",onClick:()=>{o===""?s.notify("Can't create an assembly without a name"):(n(),s.addAssembly({name:o,displayName:t,sequence:{type:"ReferenceSequenceTrack",trackId:`${o}-${performance.now()}`,adapter:i==="IndexedFastaAdapter"?{type:"IndexedFastaAdapter",fastaLocation:m,faiLocation:h}:i==="BgzipFastaAdapter"?{type:"BgzipFastaAdapter",fastaLocation:m,faiLocation:h,gziLocation:A}:i==="UnindexedFastaAdapter"?{type:"UnindexedFastaAdapter",fastaLocation:m}:{type:"TwoBitAdapter",twoBitLocation:v,chromSizesLocation:S}}}),s.notify(`Added "${o}"`,"success"))},children:"Submit"}),e.jsx(u,{variant:"contained",color:"secondary",onClick:()=>{n()},children:"Cancel"})]})]})}),W=k()({container:{overflow:"auto",maxHeight:600}}),G=d(function({assembly:s,onClose:n}){const{classes:o}=W();return e.jsxs(e.Fragment,{children:[e.jsx(b,{children:e.jsx("div",{className:o.container,children:s?e.jsx(I,{model:{target:s}}):e.jsx("div",{children:"No assembly"})})}),e.jsx(F,{children:e.jsx(u,{variant:"contained",onClick:()=>{n()},children:"Back"})})]})}),Q=H(e.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Create"),X=d(function({onEditAssembly:s,onAddAssembly:n,onClose:o,session:a}){return e.jsxs(e.Fragment,{children:[e.jsx(b,{children:e.jsx($,{children:e.jsx(J,{rowHeight:25,columnHeaderHeight:35,hideFooter:a.assemblies.length<25,rows:a.assemblies.map(t=>({id:j.readConfObject(t,"name"),name:j.readConfObject(t,"name"),displayName:j.readConfObject(t,"displayName"),aliases:j.readConfObject(t,"aliases"),assembly:t})),columns:[{field:"name"},{field:"displayName"},{field:"aliases"},{field:"actions",renderCell:({row:t})=>{const{assembly:l,name:i}=t,x=a.sessionAssemblies.includes(l)?!0:a.adminMode;return e.jsxs(e.Fragment,{children:[e.jsx(C,{disabled:!x,onClick:()=>{s(l)},children:e.jsx(Q,{})}),e.jsx(C,{"data-testid":`${i}-delete`,disabled:!x,onClick:()=>{x&&(a.removeAssembly?a.removeAssembly(i):a.notify("Unable to find removeAssembly function"))},children:e.jsx(E,{})})]})}}]})})}),e.jsxs(F,{children:[e.jsx(u,{color:"secondary",variant:"contained",onClick:()=>{o()},children:"Close"}),e.jsx(u,{variant:"contained",startIcon:e.jsx(N,{}),onClick:()=>{n()},children:"Add new assembly"})]})]})}),de=d(function({session:s,onClose:n}){const[o,a]=r.useState(!1),[t,l]=r.useState();return e.jsx(c.Dialog,{open:!0,title:"Assembly manager",onClose:()=>{n()},children:t?e.jsx(G,{assembly:t,onClose:()=>{l(void 0)}}):o?e.jsx(V,{session:s,onClose:()=>{a(!1)}}):e.jsx(X,{session:s,onClose:()=>{n()},onAddAssembly:()=>{a(!0)},onEditAssembly:i=>{l(i)}})})});export{de as default};
