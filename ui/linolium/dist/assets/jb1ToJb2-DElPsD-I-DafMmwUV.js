import{u as f,t as n}from"./JBrowsePanel-CjeUdi3D-Dhrr89W5.js";import"./index-Bwk-R6QR.js";import"./taxonium-component.es-D8UFPkMd.js";function F(e,l,u){var c,p,d,T,s;const t={trackId:f.objectHash(e),name:e.key||e.label},y=e.metadata&&(e.metadata.description||e.metadata.Description);y&&(t.description=y);const U=e.category||((c=e.metadata)===null||c===void 0?void 0:c.category);t.category=U?U.split(/\s*\/\s*/):[];const{storeClass:i}=e;if(!e.urlTemplate){if(!(i!=null&&i.endsWith("FromConfig"))){const a=e.key||e.label;return console.warn(`Could not import JBrowse1 track "${a}" because it does not have a "urlTemplate" or is not a "FromConfig" track`),n.generateUnsupportedTrackConf(t.name,a,t.category)}return m(e,t)}const o=a=>new URL(a,`${l}/`).href.replaceAll(/%7B/gi,"{").replaceAll(/%7D/gi,"}"),r=o(e.urlTemplate);if(i){if(i==="JBrowse/Store/SeqFeature/BAM"){const a={type:"BamAdapter",bamLocation:{uri:r,locationType:"UriLocation"}};return e.baiUrlTemplate?a.index={location:{uri:o(e.baiUrlTemplate),locationType:"UriLocation"}}:e.csiUrlTemplate?a.index={location:{uri:o(e.csiUrlTemplate),locationType:"UriLocation"},indexType:"CSI"}:a.index={location:{uri:`${r}.bai`,locationType:"UriLocation"}},{...t,type:"AlignmentsTrack",adapter:a}}if(i==="JBrowse/Store/SeqFeature/CRAM"){const a={type:"CramAdapter",cramLocation:{uri:r,locationType:"UriLocation"},sequenceAdapter:u};return a.craiLocation=e.craiUrlTemplate?{uri:o(e.craiUrlTemplate),locationType:"UriLocation"}:{uri:`${r}.crai`,locationType:"UriLocation"},{...t,type:"AlignmentsTrack",adapter:a}}if(i==="JBrowse/Store/SeqFeature/NCList")return{...t,type:"FeatureTrack",adapter:{type:"NCListAdapter",rootUrlTemplate:{uri:r,locationType:"UriLocation"}}};if(i==="JBrowse/Store/SeqFeature/BigWig"||i==="JBrowse/Store/BigWig")return!((p=e.type)===null||p===void 0)&&p.endsWith("XYPlot")?t.defaultRendering="xyplot":!((d=e.type)===null||d===void 0)&&d.endsWith("Density")&&(t.defaultRendering="density"),{...t,type:"QuantitativeTrack",adapter:{type:"BigWigAdapter",bigWigLocation:{uri:r,locationType:"UriLocation"}}};if(i==="JBrowse/Store/SeqFeature/VCFTabix"){const a={type:"VcfTabixAdapter",vcfGzLocation:{uri:r,locationType:"UriLocation"}};return e.tbiUrlTemplate?a.index={location:{uri:o(e.tbiUrlTemplate),locationType:"UriLocation"}}:e.csiUrlTemplate?a.index={location:{uri:o(e.csiUrlTemplate),locationType:"UriLocation"},indexType:"CSI"}:a.index={location:{uri:`${r}.tbi`,locationType:"UriLocation"}},{...t,type:"VariantTrack",adapter:a}}if(i==="JBrowse/Store/SeqFeature/VCFTribble")return n.generateUnsupportedTrackConf(t.name,`VCFTribble (${r})`,t.category);if(i==="JBrowse/Store/SeqFeature/GFF3")return{...t,type:"FeatureTrack",adapter:{type:"Gff3Adapter",gffLocation:{uri:r,locationType:"UriLocation"}}};if(i==="JBrowse/Store/SeqFeature/BigBed")return{...t,type:"FeatureTrack",adapter:{type:"BigBedAdapter",bigBedLocation:{uri:r,locationType:"UriLocation"}}};if(i==="JBrowse/Store/SeqFeature/GFF3Tabix"){const a={type:"Gff3TabixAdapter",gffGzLocation:{uri:r,locationType:"UriLocation"}};return e.tbiUrlTemplate?a.index={location:{uri:o(e.tbiUrlTemplate),locationType:"UriLocation"}}:e.csiUrlTemplate?a.index={location:{uri:o(e.csiUrlTemplate),locationType:"UriLocation"},indexType:"CSI"}:a.index={location:{uri:`${r}.tbi`,locationType:"UriLocation"}},{...t,type:"FeatureTrack",adapter:a}}if(i==="JBrowse/Store/SeqFeature/BED")return n.generateUnsupportedTrackConf(t.name,`BED (${r})`,t.category);if(i==="JBrowse/Store/SeqFeature/BEDTabix"){const a={type:"BedTabixAdapter",bedGzLocation:{uri:r,locationType:"UriLocation"}};return e.tbiUrlTemplate?a.index={location:{uri:o(e.tbiUrlTemplate),locationType:"UriLocation"}}:e.csiUrlTemplate?a.index={location:{uri:o(e.csiUrlTemplate),locationType:"UriLocation"},indexType:"CSI"}:a.index={location:{uri:`${r}.tbi`,locationType:"UriLocation"}},{...t,type:"FeatureTrack",adapter:a}}if(i==="JBrowse/Store/SeqFeature/GTF")return{...t,type:"FeatureTrack",adapter:{type:"GtfAdapter",gtfLocation:{uri:r,locationType:"UriLocation"}}};if(i==="JBrowse/Store/SeqFeature/StaticChunked"||i==="JBrowse/Store/Sequence/StaticChunked")return n.generateUnsupportedTrackConf(t.name,`StaticChunked (${r})`,t.category);if(i==="JBrowse/Store/SeqFeature/UnindexedFasta")return n.generateUnsupportedTrackConf(t.name,`UnindexedFasta (${r})`,t.category);if(i==="JBrowse/Store/SeqFeature/IndexedFasta"){const a={type:"IndexedFastaAdapter",fastaLocation:{uri:r,locationType:"UriLocation"}};return a.faiLocation=e.faiUrlTemplate?{uri:o(e.faiUrlTemplate),locationType:"UriLocation"}:{uri:`${r}.fai`,locationType:"UriLocation"},{...t,type:"SequenceTrack",adapter:a}}if(i==="JBrowse/Store/SeqFeature/BgzipIndexedFasta"){const a={type:"BgzipFastaAdapter",fastaLocation:{uri:r,locationType:"UriLocation"}};return a.faiLocation=e.faiUrlTemplate?{uri:o(e.faiUrlTemplate),locationType:"UriLocation"}:{uri:`${r}.fai`,locationType:"UriLocation"},a.gziLocation=e.gziUrlTemplate?{uri:o(e.gziUrlTemplate),locationType:"UriLocation"}:{uri:`${r}.gzi`,locationType:"UriLocation"},{...t,type:"ReferenceSequenceTrack",adapter:a}}if(i==="JBrowse/Store/SeqFeature/TwoBit")return{...t,type:"ReferenceSequenceTrack",adapter:{type:"TwoBitAdapter",twoBitLocation:{uri:r,locationType:"UriLocation"}}}}return t.adapter=n.guessAdapter({uri:r,locationType:"UriLocation"},void 0,r),t.adapter.type===n.UNSUPPORTED?n.generateUnsupportedTrackConf(t.name,r,t.category):t.adapter.type===n.UNKNOWN?n.generateUnknownTrackConf(t.name,r,t.category):(t.type=n.guessTrackType(t.adapter.type),t.type==="QuantitativeTrack"&&(!((T=e.type)===null||T===void 0)&&T.endsWith("XYPlot")?t.defaultRendering="xyplot":!((s=e.type)===null||s===void 0)&&s.endsWith("Density")&&(t.defaultRendering="density")),t)}function m(e,l){const u=(e.features||[]).map(c=>{const p=JSON.parse(JSON.stringify(c));return p.refName=c.seq_id,p.uniqueId=`${c.seq_id}:${c.start}-${c.end}:${c.name||""}`,p});return l.adapter={type:"FromConfigAdapter",features:u},l.type="FeatureTrack",l}export{F as convertTrackConfig};
