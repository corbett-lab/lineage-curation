import{s as V,ad as W,O as Y,u as b}from"./JBrowsePanel-CjeUdi3D-Dhrr89W5.js";import"./index-Bwk-R6QR.js";import"./taxonium-component.es-D8UFPkMd.js";const q=.3,y=2;function _(e,S){const{features:C,regions:P,bpPerPx:f,scaleOpts:p,height:I,ticks:{values:M},displayCrossHatches:N,colorCallback:w,config:O,offset:c=0,stopToken:x}=S,l=P[0],E=(l.end-l.start)/f,s=I-c*2,d=V.readConfObject(O,"clipColor"),m=W({...p,range:[0,s]}),u=m.domain(),F=u[0],R=u[1],n=t=>b.clamp(s-(m(t)||0),0,s)+c;let i,T=Number.NEGATIVE_INFINITY;const h=[];let g=performance.now();for(const t of C.values()){performance.now()-g>400&&(Y.checkStopToken(x),g=performance.now());const[o,a]=b.featureSpanPx(t,l,f);(Math.floor(o)!==Math.floor(T)||a-o>1)&&(h.push(t),T=o);const r=t.get("score"),j=r<F,H=r>R,k=a-o+q,L=w(t,r);e.beginPath(),e.strokeStyle=L;const v=i!==void 0?i:r;l.reversed?(e.moveTo(a,n(v)),e.lineTo(a,n(r)),e.lineTo(o,n(r))):(e.moveTo(o,n(v)),e.lineTo(o,n(r)),e.lineTo(a,n(r))),e.stroke(),i=r,H?(e.fillStyle=d,e.fillRect(o,c,k,y)):j&&p.scaleType!=="log"&&(e.fillStyle=d,e.fillRect(o,s-y,k,s))}if(N){e.lineWidth=1,e.strokeStyle="rgba(200,200,200,0.5)";for(const t of M)e.beginPath(),e.moveTo(0,Math.round(n(t))),e.lineTo(E,Math.round(n(t))),e.stroke()}return{reducedFeatures:h}}export{_ as drawLine};
