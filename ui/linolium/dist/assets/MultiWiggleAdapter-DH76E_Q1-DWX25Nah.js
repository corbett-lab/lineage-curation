import{e as l}from"./index-Bp4pXTEU-Cipcrd2k.js";import{u as p}from"./JBrowsePanel-CjeUdi3D-Dhrr89W5.js";import{o as c}from"./rxjs-euq-mp90-DvajfGj-.js";import{I as d,d as m}from"./merge-u3ffhOnq-DClX53QV.js";import"./index-Bwk-R6QR.js";import"./taxonium-component.es-D8UFPkMd.js";import"./Observable-ztGTW3Os-DRs2VX0K.js";function g(o){const a=o.slice(o.lastIndexOf("/")+1);return a.slice(0,a.lastIndexOf("."))}class f extends l.BaseFeatureDataAdapter{async getAdapters(){const a=this.getSubAdapter;if(!a)throw new Error("no getSubAdapter available");let t=this.getConf("subadapters");return t!=null&&t.length||(t=this.getConf("bigWigs").map(e=>({type:"BigWigAdapter",source:g(e),bigWigLocation:{uri:e}}))),Promise.all(t.map(async e=>{const s=(await a(e)).dataAdapter;return{source:e.name||s.id,...e,dataAdapter:s}}))}async getRefNames(a){const t=await this.getAdapters(),e=await Promise.all(t.map(s=>s.dataAdapter.getRefNames(a)));return[...new Set(e.flat())]}async getGlobalStats(a){const t=await this.getAdapters(),e=(await Promise.all(t.map(r=>{var u,n;return(n=(u=r.dataAdapter).getGlobalStats)===null||n===void 0?void 0:n.call(u,a)}))).filter(r=>!!r),s=p.min(e.map(r=>r.scoreMin)),i=p.max(e.map(r=>r.scoreMax));return{scoreMin:s,scoreMax:i}}getFeatures(a,t={}){return c.ObservableCreate(async e=>{const s=await this.getAdapters();d(...s.map(i=>i.dataAdapter.getFeatures(a,t).pipe(m(r=>r.get("source")?r:new p.SimpleFeature({...r.toJSON(),uniqueId:`${i.source}-${r.id()}`,source:i.source}))))).subscribe(e)},t.stopToken)}async getMultiRegionFeatureDensityStats(a){return{featureDensity:0}}async getSources(a){return(await this.getAdapters()).map(({dataAdapter:t,source:e,name:s,...i})=>({name:e,__name:s,...i}))}}f.capabilities=["hasResolution","hasLocalStats","hasGlobalStats"];export{f as default};
