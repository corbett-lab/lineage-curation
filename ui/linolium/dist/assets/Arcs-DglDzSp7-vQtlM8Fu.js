const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ArcTooltip-Csc4ZvHd-Bmj0syMn.js","assets/index-Bwk-R6QR.js","assets/JBrowsePanel-CjeUdi3D-Dhrr89W5.js","assets/taxonium-component.es-D8UFPkMd.js"])))=>i.map(i=>d[i]);
import{j as d,r as M,_ as R}from"./index-Bwk-R6QR.js";import{o as C,u as m,s as T,aG as F}from"./JBrowsePanel-CjeUdi3D-Dhrr89W5.js";function V(e,t){var o,n,s,i;const l=t?F(t):void 0,u=e.get("start");let r=e.get("end");const v=e.get("strand"),f=e.get("mate"),c=e.get("refName");let x,h=0,k=0,p=0,N=0;if(["<TRA","<DEL","<INV","<INS","<DUP","<CNV"].some(a=>t==null?void 0:t.startsWith(a))){const a=e.get("INFO"),g=(n=(o=a==null?void 0:a.END)===null||o===void 0?void 0:o[0])!==null&&n!==void 0?n:r;x=(i=(s=a==null?void 0:a.CHR2)===null||s===void 0?void 0:s[0])!==null&&i!==void 0?i:c,h=g,k=g-1,r=u+1}else if(l!=null&&l.MatePosition){const a=l.MatePosition.split(":");N=l.MateDirection==="left"?1:-1,p=l.Join==="left"?-1:1,h=+a[1],k=+a[1]-1,x=a[0]}return{k1:{refName:c,start:u,end:r,strand:v,mateDirection:N},k2:f??{refName:x||"unknown",end:h,start:k,mateDirection:p}}}function G(e,t){var o;const{k1:n,k2:s}=V(e,t);return[e.get("name"),e.get("id"),m.assembleLocString(n),m.assembleLocString(s),(o=e.get("INFO"))===null||o===void 0?void 0:o.SVTYPE,t].filter(i=>!!i).join("<br/>")}const I=M.lazy(()=>R(()=>import("./ArcTooltip-Csc4ZvHd-Bmj0syMn.js"),__vite__mapDeps([0,1,2,3]))),E=C(function({model:e,feature:t,alt:o,assembly:n,view:s}){var i,l;const[u,r]=M.useState(!1),{height:v}=e,{k1:f,k2:c}=V(t,o),x=M.useRef(null),h=T.getConf(e,"color",{feature:t,alt:o}),k=n.getCanonicalRefName(f.refName)||f.refName,p=n.getCanonicalRefName(c.refName)||c.refName,N=f.start,a=c.start,g=(i=s.bpToPx({refName:k,coord:N}))===null||i===void 0?void 0:i.offsetPx,j=(l=s.bpToPx({refName:p,coord:a}))===null||l===void 0?void 0:l.offsetPx;if(g!==void 0&&j!==void 0){const _=(j-g)/2,D=Math.abs(_),O=Math.min(v,D),$=g-s.offsetPx,w=j-s.offsetPx,P=$,b=w,S=u?"black":h,y=3;return D>1?d.jsxs(d.Fragment,{children:[d.jsx("path",{d:`M ${P} 0 C ${P} ${O}, ${b} ${O}, ${b} 0`,ref:x,...m.getStrokeProps(S),strokeWidth:y,onMouseOut:()=>{r(!1)},onMouseOver:()=>{r(!0)},onClick:()=>{e.selectFeature(t)},fill:"none",pointerEvents:"stroke"}),f.mateDirection?d.jsx("line",{...m.getStrokeProps(S),strokeWidth:y,onMouseOut:()=>{r(!1)},onMouseOver:()=>{r(!0)},onClick:()=>{e.selectFeature(t)},x1:P,x2:P+f.mateDirection*20,y1:1.5,y2:1.5}):null,c.mateDirection?d.jsx("line",{...m.getStrokeProps(S),strokeWidth:y,onMouseOut:()=>{r(!1)},onMouseOver:()=>{r(!0)},onClick:()=>{e.selectFeature(t)},x1:b,x2:b+c.mateDirection*20,y1:1.5,y2:1.5}):null,u?d.jsx(M.Suspense,{fallback:null,children:d.jsx(I,{contents:G(t,o)})}):null]}):null}return null}),L=C(function({model:e,exportSVG:t,children:o}){const{height:n}=e,s=m.getContainingView(e),i=Math.round(s.dynamicBlocks.totalWidthPx);return t?o:d.jsx("svg",{width:i,height:n,children:o})}),Y=C(function({model:e,exportSVG:t}){const o=m.getContainingView(e),n=m.getSession(e),{assemblyManager:s}=n,{features:i}=e,l=s.get(o.assemblyNames[0]);return l?d.jsx(L,{model:e,exportSVG:t,children:i==null?void 0:i.map(u=>{var r;const v=u.get("ALT");return(r=v==null?void 0:v.map(f=>d.jsx(E,{session:n,feature:u,alt:f,view:o,model:e,assembly:l},`${u.id()}-${f}`)))!==null&&r!==void 0?r:d.jsx(E,{session:n,feature:u,view:o,model:e,assembly:l},u.id())})}):null});export{Y as U};
