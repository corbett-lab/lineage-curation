const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BreakendSingleLevelOptionDialog-Bh6-QJp--CFiPbdMt.js","assets/JBrowsePanel-CjeUdi3D-Dhrr89W5.js","assets/index-Bwk-R6QR.js","assets/taxonium-component.es-D8UFPkMd.js","assets/FormControlLabel-t1db3bCW-BhUWxcLA.js","assets/Checkbox-DRfuV2d3-Bnouab3n.js"])))=>i.map(i=>d[i]);
import{j as r,r as y,_ as x}from"./index-Bwk-R6QR.js";import{t as b}from"./BaseCard-Bb7pKL_2-B3TEoNCR.js";import{u as f,T as w,bh as $,a as E,bf as I,q as L,bg as C}from"./JBrowsePanel-CjeUdi3D-Dhrr89W5.js";import{_ as v}from"./Link-D75pU1-Z-CqDhRF3I.js";import{n as D}from"./AlignmentsFeatureDetail-C3RfJO0G-C5n1cmh1.js";import"./taxonium-component.es-D8UFPkMd.js";import"./FeatureDetails-CJuhR-8z-9jq4voUN.js";import"./FormControlLabel-t1db3bCW-BhUWxcLA.js";import"./Checkbox-DRfuV2d3-Bnouab3n.js";async function M({view:e,feature:s}){var a;const{assemblyManager:o}=f.getSession(e),n=s.get("CIGAR"),l=s.get("strand"),c=((a=s.get("tags"))===null||a===void 0?void 0:a.SA)||"",d=s.get("name"),t=I(n,1),p=await o.waitForAssembly(e.assemblyNames[0]);if(!p)throw new Error("assembly not found");const u=L(c,s.id(),l,d,!0),i=s.toJSON();i.clipPos=t,i.strand=1,i.mate={refName:d,start:t,end:t+C(n)};const h=[i,...u];for(const[g,m]of h.entries())m.refName=p.getCanonicalRefName(m.refName)||m.refName,m.syntenyId=g,m.mate.syntenyId=g,m.mate.uniqueId=`${m.uniqueId}_mate`;return h.sort((g,m)=>g.clipPos-m.clipPos),h}const P=y.lazy(()=>x(()=>import("./BreakendSingleLevelOptionDialog-Bh6-QJp--CFiPbdMt.js").then(e=>e.B),__vite__mapDeps([0,1,2,3,4,5]))),R=y.lazy(()=>x(()=>import("./BreakendSingleLevelOptionDialog-Bh6-QJp--CFiPbdMt.js").then(e=>e.a),__vite__mapDeps([0,1,2,3,4,5])));function q({model:e,feature:s}){const{view:a}=e,[o,n]=y.useState(),[l,c]=y.useState();y.useEffect(()=>{(async()=>{try{const t=await M({view:a,feature:new f.SimpleFeature(s)});n(t)}catch(t){c(t),console.error(t)}})()},[s,a]);const d=[];if(o)for(let t=0;t<o.length-1;t++)d.push([o[t],o[t+1]]);return d.length?r.jsxs("div",{children:[r.jsx(w,{children:"Launch split view"}),l?r.jsx(E.ErrorMessage,{error:l}):null,r.jsx("ul",{children:d.map((t,p)=>{const[u,i]=t;return r.jsxs("li",{children:[u.refName,":",f.toLocale(u.strand===1?u.end:u.start)," ->"," ",i.refName,":",f.toLocale(i.strand===1?i.start:i.end)," ",r.jsx(A,{model:e,f1:u,f2:i})," ",r.jsx(T,{model:e,f1:u,f2:i})]},`${JSON.stringify(t)}-${p}`)})})]}):null}function A({model:e,f1:s,f2:a}){return r.jsx(v,{href:"#",onClick:o=>{o.preventDefault();const n=f.getSession(e);n.queueDialog(l=>[P,{handleClose:l,session:n,feature:new f.SimpleFeature({...s,mate:a}),view:e.view,assemblyName:e.view.displayedRegions[0].assemblyName}])},children:"(top/bottom)"})}function T({model:e,f1:s,f2:a}){return r.jsx(v,{href:"#",onClick:o=>{o.preventDefault();const n=f.getSession(e);n.queueDialog(l=>[R,{handleClose:l,session:n,feature:new f.SimpleFeature({...s,mate:a}),view:e.view,assemblyName:e.view.displayedRegions[0].assemblyName}])},children:"(single row)"})}function F({tag:e,model:s}){return r.jsxs("div",{children:[r.jsx(w,{children:"List of supplementary alignment locations"}),r.jsx("ul",{children:e.split(";").filter(a=>!!a).map((a,o)=>{const[n,l,c,d]=a.split(","),t=$(d),p=Math.floor(t/5),u=+l,i=+l+t,h=u-p,g=i+p,m=`${n}:${Math.max(1,h)}-${g}`,S=u.toLocaleString("en-US"),j=i.toLocaleString("en-US"),N=`${n}:${S}-${j} (${c}) [${t}bp]`;return r.jsx("li",{children:r.jsx(v,{href:"#",onClick:async _=>{_.preventDefault(),D(m,s)},children:N})},`${m}-${o}`)})})]})}function Y(e){const{model:s,tag:a,feature:o}=e,n=f.getSession(s),{pluginManager:l}=f.getEnv(n);let c=!1;try{c=!!l.getViewType("BreakpointSplitView")}catch{}return r.jsxs(b,{...e,title:"Supplementary alignments",children:[r.jsx(F,{model:s,tag:a}),c?r.jsx(q,{model:s,feature:o}):null]})}export{Y as default};
