const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FacetedDialog-CqFn_Og6-CltLsmDn.js","assets/index-Bwk-R6QR.js","assets/JBrowsePanel-CjeUdi3D-Dhrr89W5.js","assets/taxonium-component.es-D8UFPkMd.js","assets/SanitizedHTML-BuU69Ctr-BSE6rulZ.js","assets/Clear-Bq9BgXq5-zru5vVp-.js","assets/DataGrid-CtzhbUAR-B5avypAp.js","assets/getThemeProps-VQY9obTE-DyGMZP3D.js","assets/FormControlLabel-t1db3bCW-BhUWxcLA.js","assets/MenuItem-bcu4bG3--CNW0nWZm.js","assets/dividerClasses-CVTzPOoo-DLNaoCl0.js","assets/Divider-DzCbFD9M-BaKdmFVz.js","assets/Badge-DesLZhxI-BI0lVxgb.js","assets/TableCell-mfS6Ut2J-N_4-_qc3.js","assets/Checkbox-DRfuV2d3-Bnouab3n.js","assets/Grid-C8gEqkWK-DXtd0Rrk.js","assets/CloseConnectionDialog-dvo1zv1n-CDpSuAbx.js","assets/DialogContentText-InFbTjBo-BLNq3_Le.js","assets/ListItem-BegJmGel-CD2nrZTw.js","assets/DeleteConnectionDialog-ZCbTXbjc-CSkufmyL.js","assets/ManageConnectionsDialog-DCji8P0b-B-8PShqP.js","assets/ToggleConnectionsDialog-eAuZGSQz-AQECP9Rm.js"])))=>i.map(i=>d[i]);
import{j as d,r as C,_ as B,R as Ie}from"./index-Bwk-R6QR.js";import{o as R,u as T,cy as K,U as E,m as W,bp as Be,cx as qe,E as Ue,G as $e,cz as Ke,s as Re,c as Je,bG as Ge,a4 as Oe,a3 as oe,aQ as te,H as Qe,a$ as Xe,aJ as Ze,I as G,z as Ye,aR as et,t as tt,cA as se,cB as L,cC as ae,cD as it,A as nt,T as rt,cE as ot}from"./JBrowsePanel-CjeUdi3D-Dhrr89W5.js";import{q as fe,Q as st,O as q,o as S,H as at}from"./taxonium-component.es-D8UFPkMd.js";import{J as pe}from"./MenuItem-bcu4bG3--CNW0nWZm.js";import{e as lt}from"./Clear-Bq9BgXq5-zru5vVp-.js";import{g as le}from"./Badge-DesLZhxI-BI0lVxgb.js";import{e as je}from"./SanitizedHTML-BuU69Ctr-BSE6rulZ.js";import{F as ct}from"./FormControlLabel-t1db3bCW-BhUWxcLA.js";import{X as dt}from"./Checkbox-DRfuV2d3-Bnouab3n.js";import"./dividerClasses-CVTzPOoo-DLNaoCl0.js";function ut(e){return nt("MuiFab",e)}const me=Ye("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]),ht=e=>{const{color:t,variant:i,classes:n,size:r}=e,o={root:["root",i,`size${te(r)}`,t==="inherit"?"colorInherit":t]},c=Qe(o,ut,n);return{...n,...c}},ft=$e(Xe,{name:"MuiFab",slot:"Root",shouldForwardProp:e=>Ze(e)||e==="classes",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,t[i.variant],t[`size${te(i.size)}`],i.color==="inherit"&&t.colorInherit,t[te(i.size)],t[i.color]]}})(G(({theme:e})=>{var t,i;return{...e.typography.button,minHeight:36,transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(e.vars||e).zIndex.fab,boxShadow:(e.vars||e).shadows[6],"&:active":{boxShadow:(e.vars||e).shadows[12]},color:e.vars?e.vars.palette.grey[900]:(i=(t=e.palette).getContrastText)==null?void 0:i.call(t,e.palette.grey[300]),backgroundColor:(e.vars||e).palette.grey[300],"&:hover":{backgroundColor:(e.vars||e).palette.grey.A100,"@media (hover: none)":{backgroundColor:(e.vars||e).palette.grey[300]},textDecoration:"none"},[`&.${me.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]},variants:[{props:{size:"small"},style:{width:40,height:40}},{props:{size:"medium"},style:{width:48,height:48}},{props:{variant:"extended"},style:{borderRadius:48/2,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48}},{props:{variant:"extended",size:"small"},style:{width:"auto",padding:"0 8px",borderRadius:34/2,minWidth:34,height:34}},{props:{variant:"extended",size:"medium"},style:{width:"auto",padding:"0 16px",borderRadius:40/2,minWidth:40,height:40}},{props:{color:"inherit"},style:{color:"inherit"}}]}}),G(({theme:e})=>({variants:[...Object.entries(e.palette).filter(et(["dark","contrastText"])).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].contrastText,backgroundColor:(e.vars||e).palette[t].main,"&:hover":{backgroundColor:(e.vars||e).palette[t].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[t].main}}}}))]})),G(({theme:e})=>({[`&.${me.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}}))),Me=C.forwardRef(function(e,t){const i=Ue({props:e,name:"MuiFab"}),{children:n,className:r,color:o="default",component:c="button",disabled:u=!1,disableFocusRipple:p=!1,focusVisibleClassName:h,size:l="large",variant:v="circular",...m}=i,y={...i,color:o,component:c,disabled:u,disableFocusRipple:p,size:l,variant:v},a=ht(y);return d.jsx(ft,{className:fe(a.root,r),component:c,disabled:u,focusRipple:!p,focusVisibleClassName:fe(a.focusVisible,h),ownerState:y,ref:t,...m,classes:a,children:n})});q.env.NODE_ENV!=="production"&&(Me.propTypes={children:S.node,classes:S.object,className:S.string,color:S.oneOfType([S.oneOf(["default","error","info","inherit","primary","secondary","success","warning"]),S.string]),component:S.elementType,disabled:S.bool,disableFocusRipple:S.bool,disableRipple:S.bool,focusVisibleClassName:S.string,href:S.string,size:S.oneOfType([S.oneOf(["small","medium","large"]),S.string]),sx:S.oneOfType([S.arrayOf(S.oneOfType([S.func,S.object,S.bool])),S.func,S.object]),variant:S.oneOfType([S.oneOf(["circular","extended"]),S.string])});let I;typeof window<"u"?I=window:typeof self<"u"?I=self:I=at;let ie=null,ne=null;const ge=20,Q=I.clearTimeout,ve=I.setTimeout,X=I.cancelAnimationFrame||I.mozCancelAnimationFrame||I.webkitCancelAnimationFrame,_e=I.requestAnimationFrame||I.mozRequestAnimationFrame||I.webkitRequestAnimationFrame;X==null||_e==null?(ie=Q,ne=function(e){return ve(e,ge)}):(ie=function([e,t]){X(e),Q(t)},ne=function(e){const t=_e(function(){Q(i),e()}),i=ve(function(){X(t),e()},ge);return[t,i]});function pt(e){let t,i,n,r,o,c,u;const p=typeof document<"u"&&document.attachEvent;if(!p){c=function(s){const f=s.__resizeTriggers__,g=f.firstElementChild,b=f.lastElementChild,_=g.firstElementChild;b.scrollLeft=b.scrollWidth,b.scrollTop=b.scrollHeight,_.style.width=g.offsetWidth+1+"px",_.style.height=g.offsetHeight+1+"px",g.scrollLeft=g.scrollWidth,g.scrollTop=g.scrollHeight},o=function(s){return s.offsetWidth!==s.__resizeLast__.width||s.offsetHeight!==s.__resizeLast__.height},u=function(s){if(s.target.className&&typeof s.target.className.indexOf=="function"&&s.target.className.indexOf("contract-trigger")<0&&s.target.className.indexOf("expand-trigger")<0)return;const f=this;c(this),this.__resizeRAF__&&ie(this.__resizeRAF__),this.__resizeRAF__=ne(function(){o(f)&&(f.__resizeLast__.width=f.offsetWidth,f.__resizeLast__.height=f.offsetHeight,f.__resizeListeners__.forEach(function(g){g.call(f,s)}))})};let l=!1,v="";n="animationstart";const m="Webkit Moz O ms".split(" ");let y="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),a="";{const s=document.createElement("fakeelement");if(s.style.animationName!==void 0&&(l=!0),l===!1){for(let f=0;f<m.length;f++)if(s.style[m[f]+"AnimationName"]!==void 0){a=m[f],v="-"+a.toLowerCase()+"-",n=y[f],l=!0;break}}}i="resizeanim",t="@"+v+"keyframes "+i+" { from { opacity: 0; } to { opacity: 0; } } ",r=v+"animation: 1ms "+i+"; "}const h=function(l){if(!l.getElementById("detectElementResize")){const v=(t||"")+".resize-triggers { "+(r||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',m=l.head||l.getElementsByTagName("head")[0],y=l.createElement("style");y.id="detectElementResize",y.type="text/css",e!=null&&y.setAttribute("nonce",e),y.styleSheet?y.styleSheet.cssText=v:y.appendChild(l.createTextNode(v)),m.appendChild(y)}};return{addResizeListener:function(l,v){if(p)l.attachEvent("onresize",v);else{if(!l.__resizeTriggers__){const m=l.ownerDocument,y=I.getComputedStyle(l);y&&y.position==="static"&&(l.style.position="relative"),h(m),l.__resizeLast__={},l.__resizeListeners__=[],(l.__resizeTriggers__=m.createElement("div")).className="resize-triggers";const a=m.createElement("div");a.className="expand-trigger",a.appendChild(m.createElement("div"));const s=m.createElement("div");s.className="contract-trigger",l.__resizeTriggers__.appendChild(a),l.__resizeTriggers__.appendChild(s),l.appendChild(l.__resizeTriggers__),c(l),l.addEventListener("scroll",u,!0),n&&(l.__resizeTriggers__.__animationListener__=function(f){f.animationName===i&&c(l)},l.__resizeTriggers__.addEventListener(n,l.__resizeTriggers__.__animationListener__))}l.__resizeListeners__.push(v)}},removeResizeListener:function(l,v){if(p)l.detachEvent("onresize",v);else if(l.__resizeListeners__.splice(l.__resizeListeners__.indexOf(v),1),!l.__resizeListeners__.length){l.removeEventListener("scroll",u,!0),l.__resizeTriggers__.__animationListener__&&(l.__resizeTriggers__.removeEventListener(n,l.__resizeTriggers__.__animationListener__),l.__resizeTriggers__.__animationListener__=null);try{l.__resizeTriggers__=!l.removeChild(l.__resizeTriggers__)}catch{}}}}}class mt extends C.Component{constructor(...t){super(...t),this.state={height:this.props.defaultHeight||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._didLogDeprecationWarning=!1,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;const{disableHeight:i,disableWidth:n,onResize:r}=this.props;if(this._parentNode){const o=window.getComputedStyle(this._parentNode)||{},c=parseFloat(o.paddingLeft||"0"),u=parseFloat(o.paddingRight||"0"),p=parseFloat(o.paddingTop||"0"),h=parseFloat(o.paddingBottom||"0"),l=this._parentNode.getBoundingClientRect(),v=l.height-p-h,m=l.width-c-u;if(!i&&this.state.height!==v||!n&&this.state.width!==m){this.setState({height:v,width:m});const y=()=>{this._didLogDeprecationWarning||(this._didLogDeprecationWarning=!0,console.warn("scaledWidth and scaledHeight parameters have been deprecated; use width and height instead"))};typeof r=="function"&&r({height:v,width:m,get scaledHeight(){return y(),v},get scaledWidth(){return y(),m}})}}},this._setRef=i=>{this._autoSizer=i}}componentDidMount(){const{nonce:t}=this.props,i=this._autoSizer?this._autoSizer.parentNode:null;if(i!=null&&i.ownerDocument&&i.ownerDocument.defaultView&&i instanceof i.ownerDocument.defaultView.HTMLElement){this._parentNode=i;const n=i.ownerDocument.defaultView.ResizeObserver;n!=null?(this._resizeObserver=new n(()=>{this._timeoutId=setTimeout(this._onResize,0)}),this._resizeObserver.observe(i)):(this._detectElementResize=pt(t),this._detectElementResize.addResizeListener(i,this._onResize)),this._onResize()}}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),this._timeoutId!==null&&clearTimeout(this._timeoutId),this._resizeObserver&&this._resizeObserver.disconnect())}render(){const{children:t,defaultHeight:i,defaultWidth:n,disableHeight:r=!1,disableWidth:o=!1,doNotBailOutOnEmptyChildren:c=!1,nonce:u,onResize:p,style:h={},tagName:l="div",...v}=this.props,{height:m,width:y}=this.state,a={overflow:"visible"},s={};let f=!1;return r||(m===0&&(f=!0),a.height=0,s.height=m,s.scaledHeight=m),o||(y===0&&(f=!0),a.width=0,s.width=y,s.scaledWidth=y),c&&(f=!1),C.createElement(l,{ref:this._setRef,style:{...a,...h},...v},!f&&t(s))}}const gt=W()(e=>({fab:{position:"absolute",bottom:e.spacing(6),right:e.spacing(6)}})),vt=R(function({model:e}){const{classes:t}=gt(),i=T.getSession(e),[n,r]=C.useState(null);function o(){r(null)}const c=T.isSessionModelWithConnections(i),u=T.isSessionWithAddTracks(i);return u||c?d.jsxs(d.Fragment,{children:[d.jsx(Me,{color:"secondary",className:t.fab,onClick:p=>{r(p.currentTarget)},children:d.jsx(Be,{})}),d.jsxs(qe,{anchorEl:n,open:!!n,onClose:()=>{r(null)},children:[c?d.jsx(pe,{onClick:()=>{o(),T.isSessionModelWithWidgets(i)&&i.showWidget(i.addWidget("AddConnectionWidget","addConnectionWidget"))},children:"Add connection"}):null,u?d.jsx(pe,{onClick:()=>{o(),T.isSessionModelWithWidgets(i)&&i.showWidget(i.addWidget("AddTrackWidget","addTrackWidget",{view:e.view.id}))},children:"Add track"}):null]})]}):null}),_t=C.lazy(()=>B(()=>import("./FacetedDialog-CqFn_Og6-CltLsmDn.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]))),bt=C.lazy(()=>B(()=>import("./CloseConnectionDialog-dvo1zv1n-CDpSuAbx.js"),__vite__mapDeps([16,1,2,3,17,18]))),yt=C.lazy(()=>B(()=>import("./DeleteConnectionDialog-ZCbTXbjc-CSkufmyL.js"),__vite__mapDeps([19,1,2,3,17]))),xt=C.lazy(()=>B(()=>import("./ManageConnectionsDialog-DCji8P0b-B-8PShqP.js"),__vite__mapDeps([20,1,2,3]))),kt=C.lazy(()=>B(()=>import("./ToggleConnectionsDialog-eAuZGSQz-AQECP9Rm.js"),__vite__mapDeps([21,1,2,3,8,14]))),Ct=R(function({model:e}){const t=T.getSession(e),[i,n]=C.useState(),[r,o]=C.useState(),[c,u]=C.useState(!1),[p,h]=C.useState(!1),[l,v]=C.useState(!1);function m(y,a){var s;const f=Re.readConfObject(y,"name"),g=(s=t.prepareToBreakConnection)===null||s===void 0?void 0:s.call(t,y);if(g){const[b,_]=g;Object.keys(_).length>0?n({connectionConf:y,safelyBreakConnection:b,dereferenceTypeCount:_,name:f}):b()}a&&o({name:f,connectionConf:y})}return d.jsxs(d.Fragment,{children:[d.jsx(K,{menuItems:[{label:"Open faceted track selector",onClick:()=>{v(!0)}},...T.isSessionWithAddTracks(t)?[{label:"Add track...",onClick:()=>{T.isSessionModelWithWidgets(t)&&t.showWidget(t.addWidget("AddTrackWidget","addTrackWidget",{view:e.view.id}))}}]:[],{label:"Connections...",subMenu:[...T.isSessionModelWithConnections(t)?[{label:"Turn on/off connections...",onClick:()=>{u(!0)}}]:[],...T.isSessionModelWithConnectionEditing(t)?[{label:"Add connection...",onClick:()=>{T.isSessionModelWithWidgets(t)&&t.showWidget(t.addWidget("AddConnectionWidget","addConnectionWidget"))}},{label:"Delete connections...",onClick:()=>{h(!0)}}]:[]]},{label:"Sort...",type:"subMenu",subMenu:[{label:"Sort tracks by name",type:"checkbox",checked:e.activeSortTrackNames,onClick:()=>{e.setSortTrackNames(!e.activeSortTrackNames)}},{label:"Sort categories by name",type:"checkbox",checked:e.activeSortCategories,onClick:()=>{e.setSortCategories(!e.activeSortCategories)}}]},{label:"Collapse...",type:"subMenu",subMenu:[...e.hasAnySubcategories?[{label:"Collapse subcategories",onClick:()=>{e.collapseSubCategories()}}]:[],{label:"Collapse top-level categories",onClick:()=>{e.collapseTopLevelCategories()}},{label:"Expand all categories",onClick:()=>{e.expandAllCategories()}}]}],children:d.jsx(Ke,{})}),d.jsxs(C.Suspense,{fallback:null,children:[i?d.jsx(bt,{modalInfo:i,onClose:()=>{n(void 0)}}):null,r?d.jsx(yt,{handleClose:()=>{o(void 0)},deleteDialogDetails:r,session:t}):null,p?d.jsx(xt,{handleClose:()=>{h(!1)},breakConnection:m,session:t}):null,c?d.jsx(kt,{handleClose:()=>{u(!1)},session:t,breakConnection:m}):null,l?d.jsx(_t,{handleClose:()=>{v(!1)},model:e}):null]})]})}),St=E(d.jsx("path",{d:"M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2M1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2"}),"ShoppingCart"),wt=R(function({model:e}){const t=T.getSession(e),{selection:i}=e,{pluginManager:n}=T.getEnv(e),{adminMode:r,sessionTracks:o}=t,c=new Set(o==null?void 0:o.map(h=>h.trackId)),u=h=>r||c.has(h),p=n.evaluateExtensionPoint("TrackSelector-multiTrackMenuItems",[],{session:t});return i.length?d.jsx(K,{menuItems:[{label:"Clear selection",onClick:()=>{e.clearSelection()}},...i.every(h=>u(h.trackId))?[{label:"Delete tracks",onClick:()=>{var h;for(const l of i)(h=t.deleteTrackConf)===null||h===void 0||h.call(t,l)}}]:[],...p.map(h=>({...h,..."onClick"in h?{onClick:()=>{h.onClick(e)}}:{}}))],children:d.jsx(le,{badgeContent:i.length,color:"primary",children:d.jsx(St,{})})}):null}),zt=E(d.jsx("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Grade"),Ee=E(d.jsx("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreHoriz"),Tt=E(d.jsx("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Star"),It=E(d.jsx("path",{d:"m22 9.24-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28z"}),"StarBorderOutlined"),Rt=W()({cascadingStyle:{padding:0}}),We=function({id:e,trackId:t,stopPropagation:i,model:n,setOpen:r,conf:o}){var c,u;const{classes:p}=Rt();return d.jsx(K,{className:p.cascadingStyle,stopPropagation:i,setOpen:r,"data-testid":`htsTrackEntryMenu-${e}`,menuItems:[...((u=(c=T.getSession(n)).getTrackActionMenuItems)===null||u===void 0?void 0:u.call(c,o))||[],n.isFavorite(t)?{label:"Remove from favorites",onClick:()=>{n.removeFromFavorites(t)},icon:It}:{label:"Add to favorites",onClick:()=>{n.addToFavorites(t)},icon:Tt},{label:"Add to selection",onClick:()=>{n.addToSelection([o])}},...n.isSelected(o)?[{label:"Remove from selection",onClick:()=>{n.removeFromSelection([o])}}]:[]],children:d.jsx(Ee,{})})},Le=R(function({model:e,tracks:t,extraMenuItems:i,children:n,onClick:r}){const{view:o}=e,[c,u]=C.useState(!1),p=T.getSession(e);return o?d.jsx(K,{closeAfterItemClick:!1,onClick:r,menuItems:[...t.map(h=>({type:"checkbox",label:d.jsxs(d.Fragment,{children:[d.jsx(je,{html:tt.getTrackName(h,p)})," ",d.jsx(We,{id:h.trackId,trackId:h.trackId,model:e,conf:h,setOpen:u,stopPropagation:!0})]}),checked:o.tracks.some(l=>l.configuration===h),onClick:()=>{c||e.view.toggleTrack(h.trackId)&&e.addToRecentlyUsed(h.trackId)}})),...i],children:n}):null}),Ot=W()({smallBadge:{height:14},margin:{marginRight:10}}),jt=R(function({model:e}){const{classes:t}=Ot(),{view:i,favoriteTracks:n}=e;return i?d.jsx(Le,{onClick:()=>{e.setFavoritesCounter(0)},tracks:n,model:e,extraMenuItems:n.length?[{type:"divider"},{label:"Clear favorites",onClick:()=>{e.clearFavorites()}}]:[{label:"No favorite tracks yet",onClick:()=>{}}],children:d.jsx(oe,{title:"Favorite tracks",children:d.jsx(le,{classes:{badge:t.smallBadge},color:"secondary",anchorOrigin:{vertical:"bottom",horizontal:"right"},className:t.margin,badgeContent:e.favoritesCounter,children:d.jsx(zt,{})})})}):null}),Mt=E(d.jsx("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"}),"History"),Et=W()({smallBadge:{height:14}}),Wt=R(function({model:e}){const{classes:t}=Et(),{view:i,recentlyUsedCounter:n,recentlyUsedTracks:r}=e;return i?d.jsx(Le,{onClick:()=>{e.setRecentlyUsedCounter(0)},model:e,tracks:r,extraMenuItems:r.length?[{type:"divider"},{label:"Clear recently used",onClick:()=>{e.clearRecentlyUsed()}}]:[{label:"No recently used",onClick:()=>{}}],children:d.jsx(oe,{title:"Recently used tracks",children:d.jsx(le,{classes:{badge:t.smallBadge},anchorOrigin:{vertical:"bottom",horizontal:"right"},color:"secondary",badgeContent:n,children:d.jsx(Mt,{})})})}):null}),Lt=W()(e=>({searchBox:{margin:e.spacing(2)}})),Nt=R(function({model:e}){const{filterText:t}=e,{classes:i}=Lt();return d.jsx(Je,{className:i.searchBox,label:"Filter tracks",value:t,onChange:n=>{e.setFilterText(n.target.value)},fullWidth:!0,slotProps:{input:{endAdornment:d.jsx(Ge,{position:"end",children:d.jsx(Oe,{onClick:()=>{e.clearFilterText()},children:d.jsx(lt,{})})})}}})}),Dt=R(function({model:e,setHeaderHeight:t}){return d.jsx("div",{ref:i=>{t((i==null?void 0:i.getBoundingClientRect().height)||0)},"data-testid":"hierarchical_track_selector",children:d.jsxs("div",{style:{display:"flex"},children:[d.jsx(Ct,{model:e}),d.jsx(wt,{model:e}),d.jsx(Nt,{model:e}),d.jsx(Wt,{model:e}),d.jsx(jt,{model:e})]})})});var be=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function At(e,t){return!!(e===t||be(e)&&be(t))}function Ft(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(!At(e[i],t[i]))return!1;return!0}function Z(e,t){t===void 0&&(t=Ft);var i,n=[],r,o=!1;function c(){for(var u=[],p=0;p<arguments.length;p++)u[p]=arguments[p];return o&&i===this&&t(u,n)||(r=e.apply(this,u),o=!0,i=this,n=u),r}return c}var Ht=typeof performance=="object"&&typeof performance.now=="function",ye=Ht?function(){return performance.now()}:function(){return Date.now()};function xe(e){cancelAnimationFrame(e.id)}function Pt(e,t){var i=ye();function n(){ye()-i>=t?e.call(null):r.id=requestAnimationFrame(n)}var r={id:requestAnimationFrame(n)};return r}var Y=-1;function ke(e){if(e===void 0&&(e=!1),Y===-1||e){var t=document.createElement("div"),i=t.style;i.width="50px",i.height="50px",i.overflow="scroll",document.body.appendChild(t),Y=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return Y}var F=null;function Ce(e){if(e===void 0&&(e=!1),F===null||e){var t=document.createElement("div"),i=t.style;i.width="50px",i.height="50px",i.overflow="scroll",i.direction="rtl";var n=document.createElement("div"),r=n.style;return r.width="100px",r.height="100px",t.appendChild(n),document.body.appendChild(t),t.scrollLeft>0?F="positive-descending":(t.scrollLeft=1,t.scrollLeft===0?F="negative":F="positive-ascending"),document.body.removeChild(t),F}return F}q.env.NODE_ENV;var Vt=150,Bt=function(e,t){return e},U=null,$=null;q.env.NODE_ENV!=="production"&&typeof window<"u"&&typeof window.WeakSet<"u"&&(U=new WeakSet,$=new WeakSet);function qt(e){var t,i=e.getItemOffset,n=e.getEstimatedTotalSize,r=e.getItemSize,o=e.getOffsetForIndexAndAlignment,c=e.getStartIndexForOffset,u=e.getStopIndexForStartIndex,p=e.initInstanceProps,h=e.shouldResetStyleCacheOnItemSizeChange,l=e.validateProps;return t=(function(v){se(m,v);function m(a){var s;return s=v.call(this,a)||this,s._instanceProps=p(s.props,L(s)),s._outerRef=void 0,s._resetIsScrollingTimeoutId=null,s.state={instance:L(s),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof s.props.initialScrollOffset=="number"?s.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},s._callOnItemsRendered=void 0,s._callOnItemsRendered=Z(function(f,g,b,_){return s.props.onItemsRendered({overscanStartIndex:f,overscanStopIndex:g,visibleStartIndex:b,visibleStopIndex:_})}),s._callOnScroll=void 0,s._callOnScroll=Z(function(f,g,b){return s.props.onScroll({scrollDirection:f,scrollOffset:g,scrollUpdateWasRequested:b})}),s._getItemStyle=void 0,s._getItemStyle=function(f){var g=s.props,b=g.direction,_=g.itemSize,x=g.layout,k=s._getItemStyleCache(h&&_,h&&x,h&&b),w;if(k.hasOwnProperty(f))w=k[f];else{var z=i(s.props,f,s._instanceProps),O=r(s.props,f,s._instanceProps),j=b==="horizontal"||x==="horizontal",N=b==="rtl",D=j?z:0;k[f]=w={position:"absolute",left:N?void 0:D,right:N?D:void 0,top:j?0:z,height:j?"100%":O,width:j?O:"100%"}}return w},s._getItemStyleCache=void 0,s._getItemStyleCache=Z(function(f,g,b){return{}}),s._onScrollHorizontal=function(f){var g=f.currentTarget,b=g.clientWidth,_=g.scrollLeft,x=g.scrollWidth;s.setState(function(k){if(k.scrollOffset===_)return null;var w=s.props.direction,z=_;if(w==="rtl")switch(Ce()){case"negative":z=-_;break;case"positive-descending":z=x-b-_;break}return z=Math.max(0,Math.min(z,x-b)),{isScrolling:!0,scrollDirection:k.scrollOffset<z?"forward":"backward",scrollOffset:z,scrollUpdateWasRequested:!1}},s._resetIsScrollingDebounced)},s._onScrollVertical=function(f){var g=f.currentTarget,b=g.clientHeight,_=g.scrollHeight,x=g.scrollTop;s.setState(function(k){if(k.scrollOffset===x)return null;var w=Math.max(0,Math.min(x,_-b));return{isScrolling:!0,scrollDirection:k.scrollOffset<w?"forward":"backward",scrollOffset:w,scrollUpdateWasRequested:!1}},s._resetIsScrollingDebounced)},s._outerRefSetter=function(f){var g=s.props.outerRef;s._outerRef=f,typeof g=="function"?g(f):g!=null&&typeof g=="object"&&g.hasOwnProperty("current")&&(g.current=f)},s._resetIsScrollingDebounced=function(){s._resetIsScrollingTimeoutId!==null&&xe(s._resetIsScrollingTimeoutId),s._resetIsScrollingTimeoutId=Pt(s._resetIsScrolling,Vt)},s._resetIsScrolling=function(){s._resetIsScrollingTimeoutId=null,s.setState({isScrolling:!1},function(){s._getItemStyleCache(-1,null)})},s}m.getDerivedStateFromProps=function(a,s){return Ut(a,s),l(a),null};var y=m.prototype;return y.scrollTo=function(a){a=Math.max(0,a),this.setState(function(s){return s.scrollOffset===a?null:{scrollDirection:s.scrollOffset<a?"forward":"backward",scrollOffset:a,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},y.scrollToItem=function(a,s){s===void 0&&(s="auto");var f=this.props,g=f.itemCount,b=f.layout,_=this.state.scrollOffset;a=Math.max(0,Math.min(a,g-1));var x=0;if(this._outerRef){var k=this._outerRef;b==="vertical"?x=k.scrollWidth>k.clientWidth?ke():0:x=k.scrollHeight>k.clientHeight?ke():0}this.scrollTo(o(this.props,a,s,_,this._instanceProps,x))},y.componentDidMount=function(){var a=this.props,s=a.direction,f=a.initialScrollOffset,g=a.layout;if(typeof f=="number"&&this._outerRef!=null){var b=this._outerRef;s==="horizontal"||g==="horizontal"?b.scrollLeft=f:b.scrollTop=f}this._callPropsCallbacks()},y.componentDidUpdate=function(){var a=this.props,s=a.direction,f=a.layout,g=this.state,b=g.scrollOffset,_=g.scrollUpdateWasRequested;if(_&&this._outerRef!=null){var x=this._outerRef;if(s==="horizontal"||f==="horizontal")if(s==="rtl")switch(Ce()){case"negative":x.scrollLeft=-b;break;case"positive-ascending":x.scrollLeft=b;break;default:var k=x.clientWidth,w=x.scrollWidth;x.scrollLeft=w-k-b;break}else x.scrollLeft=b;else x.scrollTop=b}this._callPropsCallbacks()},y.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&xe(this._resetIsScrollingTimeoutId)},y.render=function(){var a=this.props,s=a.children,f=a.className,g=a.direction,b=a.height,_=a.innerRef,x=a.innerElementType,k=a.innerTagName,w=a.itemCount,z=a.itemData,O=a.itemKey,j=O===void 0?Bt:O,N=a.layout,D=a.outerElementType,A=a.outerTagName,M=a.style,Ae=a.useIsScrolling,Fe=a.width,ce=this.state.isScrolling,J=g==="horizontal"||N==="horizontal",He=J?this._onScrollHorizontal:this._onScrollVertical,de=this._getRangeToRender(),Pe=de[0],Ve=de[1],ue=[];if(w>0)for(var P=Pe;P<=Ve;P++)ue.push(C.createElement(s,{data:z,key:j(P,z),index:P,isScrolling:Ae?ce:void 0,style:this._getItemStyle(P)}));var he=n(this.props,this._instanceProps);return C.createElement(D||A||"div",{className:f,onScroll:He,ref:this._outerRefSetter,style:ae({position:"relative",height:b,width:Fe,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:g},M)},C.createElement(x||k||"div",{children:ue,ref:_,style:{height:J?"100%":he,pointerEvents:ce?"none":void 0,width:J?he:"100%"}}))},y._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var a=this.props.itemCount;if(a>0){var s=this._getRangeToRender(),f=s[0],g=s[1],b=s[2],_=s[3];this._callOnItemsRendered(f,g,b,_)}}if(typeof this.props.onScroll=="function"){var x=this.state,k=x.scrollDirection,w=x.scrollOffset,z=x.scrollUpdateWasRequested;this._callOnScroll(k,w,z)}},y._getRangeToRender=function(){var a=this.props,s=a.itemCount,f=a.overscanCount,g=this.state,b=g.isScrolling,_=g.scrollDirection,x=g.scrollOffset;if(s===0)return[0,0,0,0];var k=c(this.props,x,this._instanceProps),w=u(this.props,k,x,this._instanceProps),z=!b||_==="backward"?Math.max(1,f):1,O=!b||_==="forward"?Math.max(1,f):1;return[Math.max(0,k-z),Math.max(0,Math.min(s-1,w+O)),k,w]},m})(C.PureComponent),t.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}var Ut=function(e,t){var i=e.children,n=e.direction,r=e.height,o=e.layout,c=e.innerTagName,u=e.outerTagName,p=e.width,h=t.instance;if(q.env.NODE_ENV!=="production"){(c!=null||u!=null)&&$&&!$.has(h)&&($.add(h),console.warn("The innerTagName and outerTagName props have been deprecated. Please use the innerElementType and outerElementType props instead."));var l=n==="horizontal"||o==="horizontal";switch(n){case"horizontal":case"vertical":U&&!U.has(h)&&(U.add(h),console.warn('The direction prop should be either "ltr" (default) or "rtl". Please use the layout prop to specify "vertical" (default) or "horizontal" orientation.'));break;case"ltr":case"rtl":break;default:throw Error('An invalid "direction" prop has been specified. Value should be either "ltr" or "rtl". '+('"'+n+'" was specified.'))}switch(o){case"horizontal":case"vertical":break;default:throw Error('An invalid "layout" prop has been specified. Value should be either "horizontal" or "vertical". '+('"'+o+'" was specified.'))}if(i==null)throw Error('An invalid "children" prop has been specified. Value should be a React component. '+('"'+(i===null?"null":typeof i)+'" was specified.'));if(l&&typeof p!="number")throw Error('An invalid "width" prop has been specified. Horizontal lists must specify a number for width. '+('"'+(p===null?"null":typeof p)+'" was specified.'));if(!l&&typeof r!="number")throw Error('An invalid "height" prop has been specified. Vertical lists must specify a number for height. '+('"'+(r===null?"null":typeof r)+'" was specified.'))}},$t=50,H=function(e,t,i){var n=e,r=n.itemSize,o=i.itemMetadataMap,c=i.lastMeasuredIndex;if(t>c){var u=0;if(c>=0){var p=o[c];u=p.offset+p.size}for(var h=c+1;h<=t;h++){var l=r(h);o[h]={offset:u,size:l},u+=l}i.lastMeasuredIndex=t}return o[t]},Kt=function(e,t,i){var n=t.itemMetadataMap,r=t.lastMeasuredIndex,o=r>0?n[r].offset:0;return o>=i?Ne(e,t,r,0,i):Jt(e,t,Math.max(0,r),i)},Ne=function(e,t,i,n,r){for(;n<=i;){var o=n+Math.floor((i-n)/2),c=H(e,o,t).offset;if(c===r)return o;c<r?n=o+1:c>r&&(i=o-1)}return n>0?n-1:0},Jt=function(e,t,i,n){for(var r=e.itemCount,o=1;i<r&&H(e,i,t).offset<n;)i+=o,o*=2;return Ne(e,t,Math.min(i,r-1),Math.floor(i/2),n)},Se=function(e,t){var i=e.itemCount,n=t.itemMetadataMap,r=t.estimatedItemSize,o=t.lastMeasuredIndex,c=0;if(o>=i&&(o=i-1),o>=0){var u=n[o];c=u.offset+u.size}var p=i-o-1,h=p*r;return c+h},Gt=qt({getItemOffset:function(e,t,i){return H(e,t,i).offset},getItemSize:function(e,t,i){return i.itemMetadataMap[t].size},getEstimatedTotalSize:Se,getOffsetForIndexAndAlignment:function(e,t,i,n,r,o){var c=e.direction,u=e.height,p=e.layout,h=e.width,l=c==="horizontal"||p==="horizontal",v=l?h:u,m=H(e,t,r),y=Se(e,r),a=Math.max(0,Math.min(y-v,m.offset)),s=Math.max(0,m.offset-v+m.size+o);switch(i==="smart"&&(n>=s-v&&n<=a+v?i="auto":i="center"),i){case"start":return a;case"end":return s;case"center":return Math.round(s+(a-s)/2);case"auto":default:return n>=s&&n<=a?n:n<s?s:a}},getStartIndexForOffset:function(e,t,i){return Kt(e,i,t)},getStopIndexForStartIndex:function(e,t,i,n){for(var r=e.direction,o=e.height,c=e.itemCount,u=e.layout,p=e.width,h=r==="horizontal"||u==="horizontal",l=h?p:o,v=H(e,t,n),m=i+l,y=v.offset+v.size,a=t;a<c-1&&y<m;)a++,y+=H(e,a,n).size;return a},initInstanceProps:function(e,t){var i=e,n=i.estimatedItemSize,r={itemMetadataMap:{},estimatedItemSize:n||$t,lastMeasuredIndex:-1};return t.resetAfterIndex=function(o,c){c===void 0&&(c=!0),r.lastMeasuredIndex=Math.min(r.lastMeasuredIndex,o-1),t._getItemStyleCache(-1),c&&t.forceUpdate()},r},shouldResetStyleCacheOnItemSizeChange:!1,validateProps:function(e){var t=e.itemSize;if(q.env.NODE_ENV!=="production"&&typeof t!="function")throw Error('An invalid "itemSize" prop has been specified. Value should be a function. '+('"'+(t===null?"null":typeof t)+'" was specified.'))}});function Qt(e){return function(t){e.forEach(function(i){typeof i=="function"?i(t):i!=null&&(i.current=t)})}}var ee=function(){},Xt=function(e,t){return t===void 0&&(t=null),{child:null,isShown:t?t.public.isOpen&&t.isShown:!0,parent:t,public:e,sibling:null,visited:!1}},Zt=function(e,t){var i=t.getRecordData,n=i(e),r=n.data.id;return r},Yt=function(e){var t=e.index,i=e.data,n=i.component,r=i.getRecordData,o=i.treeData,c=e.style,u=e.isScrolling,p=r(t);return Ie.createElement(n,Object.assign({isScrolling:u,style:c,treeData:o},p))},ei=function(e,t,i){var n=e.createRecord,r=t.buildingTaskTimeout,o=t.placeholder,c=t.async,u=c===void 0?!1:c,p=t.treeWalker,h=u&&i.records!==void 0,l=i.records,v=[],m=new Map,y=r?{timeout:r}:void 0,a=new WeakMap,s=p(),f=s.next(),g=f.value,b=n(g.data,i,void 0,h?l.get(g.data.id):void 0);m.set(b.public.data.id,b),a.set(b,g);var _=b,x=!0,k=b,w=o!==void 0&&!(o===null&&!i.order),z=w?function(j){return j.timeRemaining()>0}:function(){return!0},O=function j(N){for(;_!==null;){if(!z(N)){requestIdleCallback(j,y);return}if(_.visited)_.visited=!1,_=_.sibling!==null?_.sibling:_.parent,k=_;else{var D=s.next(a.get(_)),A=D.value;if(A===void 0){x?x=!1:(_.isShown&&v.push(_.public.data.id),_.visited=_.child!==null,_=_.child!==null?_.child:_.sibling!==null?_.sibling:_.parent),k=_;continue}var M=n(A.data,i,x?void 0:_,h?l.get(A.data.id):void 0);m.set(M.public.data.id,M),a.set(M,A),!x&&k===_?k.child=M:k.sibling=M,k=M}}w&&i.setState({order:v,records:m,updateRequest:{}})};return w?requestIdleCallback(O,y):O(),o!==void 0&&u&&i.order?i:{order:v,records:m}},we=32768,ti=2,ii=function(e,t){var i=e.order,n=e.records,r=t.opennessState;if(typeof r!="object")return null;for(var o in r)if(n.has(o)){var c=r[o],u=n.get(o),p=typeof c=="boolean"?{open:c}:c,h=p.open,l=p.subtreeCallback,v=l===void 0?ee:l,m=ee,y=ee;u.isShown&&(h?(function(){for(var s=i.indexOf(o),f=u;f!==null;){if(f.sibling!==null){f=f.sibling;break}f=f.parent}var g=f===null?i.length-1-s:i.indexOf(f.public.data.id)-1-s,b=[[s+1,g]];m=function(_){if(_.isShown=_.parent?_.parent.public.isOpen&&_.parent.isShown:!0,_.isShown){var x=b[b.length-1];x.push(_.public.data.id),x.length===we+ti&&b.push([s+1+we*b.length,0])}},y=function(){for(var _=0;_<b.length;_++){var x;(x=i).splice.apply(x,b[_])}}})():u.public.isOpen&&(function(){var s=i.indexOf(o),f=0;m=function(g){g.isShown&&(f+=1),g.isShown=g.parent?g.parent.public.isOpen&&g.parent.isShown:!0},y=function(){i.splice(s+1,f)}})());for(var a=u;a!==null;)a.visited?(a.visited=!1,a=a===u?null:a.sibling!==null?a.sibling:a.parent):(a.public.isOpen=a===u?h:a.public.isOpen,v(a.public,u.public),a!==u&&m(a),a.visited=a.child!==null,a=a.child!==null?a.child:a===u?null:a.sibling!==null?a.sibling:a.parent);y()}return{order:i,records:n,updateRequest:{}}},ni=function(e){return function(t,i,n){return n.refresh?ei(e,t,i):ii(i,n)}},De=(function(e){se(t,e),t.getDerivedStateFromProps=function(n,r){var o=n.listRef,c=o===void 0?null:o,u=n.treeWalker,p=r.computeTree,h=r.list,l=r.order,v=r.treeWalker;return ae({attachRefs:Qt([h,c])},u!==v||!l?p(n,r,{refresh:!0}):null,{treeWalker:u})};function t(n,r){var o;return o=e.call(this,n,r)||this,o.getRecordData=o.getRecordData.bind(L(o)),o.state={list:C.createRef(),recomputeTree:o.recomputeTree.bind(L(o)),setState:o.setState.bind(L(o))},o}var i=t.prototype;return i.getItemData=function(){var n=this.props,r=n.children,o=n.itemData;return{component:r,getRecordData:this.getRecordData,treeData:o}},i.getRecordData=function(n){var r=this.state,o=r.order,c=r.records;return c.get(o[n]).public},i.recomputeTree=function(n){var r=this;return new Promise(function(o){r.setState(function(c){return c.computeTree(r.props,c,{opennessState:n})},o)})},i.scrollTo=function(n){var r;(r=this.state.list.current)==null||r.scrollTo(n)},i.scrollToItem=function(n,r){var o;(o=this.state.list.current)==null||o.scrollToItem(this.state.order.indexOf(n),r)},t})(C.PureComponent);De.defaultProps={rowComponent:Yt};var ri=ni({createRecord:function(e,t,i,n){var r=t.recomputeTree,o=t.resetAfterId,c=Xt({data:e,height:n?n.public.height:e.defaultHeight,isOpen:n?n.public.isOpen:e.isOpenByDefault,resize:function(u,p){c.public.height=u,o(c.public.data.id,p)},setOpen:function(u){var p;return r((p={},p[e.id]=u,p))}},i);return c}}),oi=(function(e){se(t,e);function t(n,r){var o;return o=e.call(this,n,r)||this,o.getItemSize=o.getItemSize.bind(L(o)),o.state=ae({},o.state,{computeTree:ri,resetAfterId:o.resetAfterId.bind(L(o))}),o}var i=t.prototype;return i.resetAfterId=function(n,r){var o;r===void 0&&(r=!1);var c=this.state,u=c.list,p=c.order;(o=u.current)==null||o.resetAfterIndex(p.indexOf(n),r)},i.recomputeTree=function(n){var r=this;return e.prototype.recomputeTree.call(this,n).then(function(){var o;(o=r.state.list.current)==null||o.resetAfterIndex(0,!0)})},i.render=function(){var n=this.props;n.children;var r=n.placeholder,o=n.itemSize,c=n.rowComponent;n.treeWalker;var u=it(n,["children","placeholder","itemSize","rowComponent","treeWalker"]),p=this.state,h=p.attachRefs,l=p.order;return r&&l.length===0?r:Ie.createElement(Gt,Object.assign({},u,{itemCount:l.length,itemData:this.getItemData(),itemKey:Zt,itemSize:o??this.getItemSize,ref:h}),c)},i.getItemSize=function(n){return this.getRecordData(n).height},t})(De),si=ot();const ai=st(si),li=E(d.jsx("path",{d:"m7 10 5 5 5-5z"}),"ArrowDropDown"),ci=E(d.jsx("path",{d:"m10 17 5-5-5-5z"}),"ArrowRight");function re(e){return(e==null?void 0:e.type)==="category"?e.children.flatMap(t=>t.type==="category"?re(t):t.conf):[]}function V(e,t=new Map){e.id&&e.children.length&&t.set(e.id,e);for(const i of e.children)V(i,t);return t}function di(e=""){return e.endsWith("(Unsupported)")||e.endsWith("(Unknown)")}const ui=W()(e=>({contrastColor:{color:e.palette.tertiary.contrastText},accordionText:{margin:"auto 0",width:"100%"}}));function hi({isOpen:e,setOpen:t,data:i}){const{classes:n}=ui(),[r,o]=C.useState(null),{menuItems:c=[],name:u,model:p,id:h,tree:l}=i;return d.jsxs("div",{className:n.accordionText,onClick:()=>{r||(i.toggleCollapse(h),t(!e))},children:[d.jsxs(rt,{"data-testid":`htsCategory-${u}`,children:[e?d.jsx(li,{}):d.jsx(ci,{}),u,d.jsx(Oe,{onClick:v=>{o(v.currentTarget),v.stopPropagation()},className:n.contrastColor,children:d.jsx(Ee,{})})]}),r?d.jsx(ai,{anchorEl:r,menuItems:[{label:"Add to selection",onClick:()=>{const v=V(l).get(h);p.addToSelection(re(v))}},{label:"Remove from selection",onClick:()=>{const v=V(l).get(h);p.removeFromSelection(re(v))}},{label:"Show all tracks",onClick:()=>{var v;for(const m of((v=V(l).get(h))===null||v===void 0?void 0:v.children)||[])m.type==="track"&&p.view.showTrack(m.trackId)}},{label:"Hide all tracks",onClick:()=>{var v;for(const m of((v=V(l).get(h))===null||v===void 0?void 0:v.children)||[])m.type==="track"&&p.view.hideTrack(m.trackId)}},...c],onMenuItemClick:(v,m)=>{m(),o(null)},open:!!r,onClose:()=>{o(null)}}):null]})}const fi=W()(e=>({compactCheckbox:{padding:0},checkboxLabel:{marginRight:0,"&:hover":{backgroundColor:e.palette.action.selected}},selected:{background:"#cccc"}}));function pi({data:e}){const{classes:t}=fi(),{checked:i,conf:n,model:r,drawerPosition:o,id:c,trackId:u,name:p,selected:h,onChange:l}=e,v=Re.readConfObject(n,"description");return d.jsxs(d.Fragment,{children:[d.jsx(oe,{title:v+(h?" (in selection)":""),placement:o==="left"?"right":"left",children:d.jsx(ct,{className:t.checkboxLabel,onClick:m=>{(m.ctrlKey||m.metaKey)&&(h?r.removeFromSelection([n]):r.addToSelection([n]),m.preventDefault())},control:d.jsx(dt,{className:t.compactCheckbox,checked:i,onChange:()=>{l(u)},disabled:di(p),slotProps:{input:{"data-testid":`htsTrackEntry-${c}`}}}),label:d.jsx("div",{"data-testid":`htsTrackLabel-${c}`,className:h?t.selected:void 0,children:d.jsx(je,{html:p})})})}),d.jsx(We,{model:r,trackId:u,id:c,conf:n})]})}const mi=W()(e=>({accordionBase:{display:"flex"},accordionCard:{padding:3,cursor:"pointer",display:"flex"},nestingLevelMarker:{position:"absolute",borderLeft:"1.5px solid #555"},accordionColor:{background:e.palette.tertiary.main,color:e.palette.tertiary.contrastText,width:"100%",display:"flex",paddingLeft:5}}));function gi({data:e,isOpen:t,style:i,setOpen:n}){const{isLeaf:r,nestingLevel:o}=e,{classes:c}=mi(),u=10,p=o*u+(r?u:0);return d.jsxs("div",{style:i,className:r?void 0:c.accordionBase,children:[new Array(o).fill(0).map((h,l)=>d.jsx("div",{style:{left:l*u+4,height:i==null?void 0:i.height},className:c.nestingLevelMarker},`mark-${l}`)),d.jsx("div",{className:r?void 0:c.accordionCard,style:{marginLeft:p,whiteSpace:"nowrap",width:"100%"},children:d.jsx("div",{className:r?void 0:c.accordionColor,children:r?d.jsx(pi,{data:e}):d.jsx(hi,{isOpen:t,data:e,setOpen:n})})})]})}function ze(e,t,i,n){const r=e.type==="track",o=r?n[e.trackId]:!1;return{data:{defaultHeight:r?22:40,isLeaf:r,isOpenByDefault:!0,nestingLevel:t,selected:o,...e,...i},nestingLevel:t,node:e}}const Te=R(function({height:e,tree:t,model:i}){const{filterText:n,selection:r,view:o}=i,c=C.useRef(null),u=T.getSession(i),{drawerPosition:p}=u,h=C.useMemo(()=>Object.fromEntries(r.map(m=>[m.trackId,m])),[r]),l=C.useMemo(()=>({onChange:m=>{o.toggleTrack(m)&&i.addToRecentlyUsed(m)},toggleCollapse:m=>{i.toggleCategory(m)},tree:t,model:i,drawerPosition:p}),[o,i,p,t]),v=C.useCallback(function*(){for(const m of t.children)yield ze(m,0,l,h);for(;;){const m=yield;for(const y of m.node.children)yield ze(y,m.nestingLevel+1,l,h)}},[t,l,h]);return C.useEffect(()=>{c.current.recomputeTree({refreshNodes:!0,useDefaultHeight:!0})},[t,n]),d.jsx(d.Fragment,{children:d.jsx(oi,{ref:c,treeWalker:v,height:e,children:gi})})}),vi=({tree:e,model:t,offset:i})=>typeof jest>"u"?d.jsx(mt,{disableWidth:!0,children:n=>d.jsx(Te,{height:(n.height||i)-i,model:t,tree:e})}):d.jsx(Te,{height:9e3,model:t,tree:e}),_i=({overrideDimensions:e,children:t})=>e?d.jsx("div",{style:{...e},children:t}):t,bi=R(function({model:e,toolbarHeight:t,overrideDimensions:i}){return d.jsxs(_i,{overrideDimensions:i,children:[d.jsx(yi,{model:e,toolbarHeight:t}),d.jsx(vt,{model:e})]})}),yi=R(function({model:e,toolbarHeight:t=0}){const[i,n]=C.useState(0);return d.jsxs(d.Fragment,{children:[d.jsx(Dt,{model:e,setHeaderHeight:n}),d.jsx(vi,{tree:e.hierarchy,model:e,offset:t+i})]})}),ji=Object.freeze(Object.defineProperty({__proto__:null,default:bi},Symbol.toStringTag,{value:"Module"}));export{ji as H,wt as S,We as T};
