const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LaunchBreakendPanel-VPq7sGPh-74QuoJd7.js","assets/index-Bwk-R6QR.js","assets/BaseCard-Bb7pKL_2-B3TEoNCR.js","assets/taxonium-component.es-D8UFPkMd.js","assets/JBrowsePanel-CjeUdi3D-Dhrr89W5.js","assets/Link-D75pU1-Z-CqDhRF3I.js","assets/VariantConsequenceDataGrid-Ba5xSnef-BIeyQ362.js","assets/FormControlLabel-t1db3bCW-BhUWxcLA.js","assets/Checkbox-DRfuV2d3-Bnouab3n.js","assets/DataGrid-CtzhbUAR-B5avypAp.js","assets/getThemeProps-VQY9obTE-DyGMZP3D.js","assets/MenuItem-bcu4bG3--CNW0nWZm.js","assets/dividerClasses-CVTzPOoo-DLNaoCl0.js","assets/Divider-DzCbFD9M-BaKdmFVz.js","assets/Badge-DesLZhxI-BI0lVxgb.js","assets/TableCell-mfS6Ut2J-N_4-_qc3.js"])))=>i.map(i=>d[i]);
import{j as n,r as f,_ as D}from"./index-Bwk-R6QR.js";import{o as I,P as oe,b_ as _,aN as re,aG as ne,u as M,c0 as ae,a as ie,b$ as se,T as G,E as q,G as H,bv as le,au as de,c as ce,aQ as E,H as P,z as V,I as Q,a$ as ue,aR as pe,A as J}from"./JBrowsePanel-CjeUdi3D-Dhrr89W5.js";import{s as fe}from"./FeatureDetails-CJuhR-8z-9jq4voUN.js";import{t as W}from"./BaseCard-Bb7pKL_2-B3TEoNCR.js";import{i as U}from"./DataGridFlexContainer-BKpGzTb2-BNeUWItU.js";import{F as X}from"./FormControlLabel-t1db3bCW-BhUWxcLA.js";import{X as Y}from"./Checkbox-DRfuV2d3-Bnouab3n.js";import{H as Z}from"./DataGrid-CtzhbUAR-B5avypAp.js";import{q as K,O as S,o as a}from"./taxonium-component.es-D8UFPkMd.js";import"./getThemeProps-VQY9obTE-DyGMZP3D.js";import"./MenuItem-bcu4bG3--CNW0nWZm.js";import"./dividerClasses-CVTzPOoo-DLNaoCl0.js";import"./Divider-DzCbFD9M-BaKdmFVz.js";import"./Badge-DesLZhxI-BI0lVxgb.js";import"./TableCell-mfS6Ut2J-N_4-_qc3.js";function me(e){return f.Children.toArray(e).filter(t=>f.isValidElement(t))}function he(e){return J("MuiToggleButton",e)}const C=V("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]),A=f.createContext({});S.env.NODE_ENV!=="production"&&(A.displayName="ToggleButtonGroupContext");const L=f.createContext(void 0);S.env.NODE_ENV!=="production"&&(L.displayName="ToggleButtonGroupButtonContext");function ve(e,t){return t===void 0||e===void 0?!1:Array.isArray(t)?t.includes(e):e===t}const ge=e=>{const{classes:t,fullWidth:o,selected:r,disabled:d,size:i,color:s}=e,l={root:["root",r&&"selected",d&&"disabled",o&&"fullWidth",`size${E(i)}`,s]};return P(l,he,t)},be=H(ue,{name:"MuiToggleButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[`size${E(o.size)}`]]}})(Q(({theme:e})=>({...e.typography.button,borderRadius:(e.vars||e).shape.borderRadius,padding:11,border:`1px solid ${(e.vars||e).palette.divider}`,color:(e.vars||e).palette.action.active,[`&.${C.disabled}`]:{color:(e.vars||e).palette.action.disabled,border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[{props:{color:"standard"},style:{[`&.${C.selected}`]:{color:(e.vars||e).palette.text.primary,backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity)}}}}},...Object.entries(e.palette).filter(pe()).map(([t])=>({props:{color:t},style:{[`&.${C.selected}`]:{color:(e.vars||e).palette[t].main,backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[t].main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.selectedOpacity)}}}}})),{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{padding:7,fontSize:e.typography.pxToRem(13)}},{props:{size:"large"},style:{padding:15,fontSize:e.typography.pxToRem(15)}}]}))),z=f.forwardRef(function(e,t){const{value:o,...r}=f.useContext(A),d=f.useContext(L),i=de({...r,selected:ve(e.value,o)},e),s=q({props:i,name:"MuiToggleButton"}),{children:l,className:u,color:c="standard",disabled:m=!1,disableFocusRipple:g=!1,fullWidth:h=!1,onChange:T,onClick:O,selected:x,size:N="medium",value:j,...w}=s,B={...s,color:c,disabled:m,disableFocusRipple:g,fullWidth:h,size:N},b=ge(B),$=v=>{O&&(O(v,j),v.defaultPrevented)||T&&T(v,j)},y=d||"";return n.jsx(be,{className:K(r.className,b.root,u,y),disabled:m,focusRipple:!g,ref:t,onClick:$,onChange:T,value:j,ownerState:B,"aria-pressed":x,...w,children:l})});S.env.NODE_ENV!=="production"&&(z.propTypes={children:a.node,classes:a.object,className:a.string,color:a.oneOfType([a.oneOf(["standard","primary","secondary","error","info","success","warning"]),a.string]),disabled:a.bool,disableFocusRipple:a.bool,disableRipple:a.bool,fullWidth:a.bool,onChange:a.func,onClick:a.func,selected:a.bool,size:a.oneOfType([a.oneOf(["small","medium","large"]),a.string]),sx:a.oneOfType([a.arrayOf(a.oneOfType([a.func,a.object,a.bool])),a.func,a.object]),value:a.any.isRequired});function ye(e){return J("MuiToggleButtonGroup",e)}const p=V("MuiToggleButtonGroup",["root","selected","horizontal","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth","firstButton","lastButton","middleButton"]),xe=e=>{const{classes:t,orientation:o,fullWidth:r,disabled:d}=e,i={root:["root",o,r&&"fullWidth"],grouped:["grouped",`grouped${E(o)}`,d&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return P(i,ye,t)},je=H("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[{[`& .${p.grouped}`]:t.grouped},{[`& .${p.grouped}`]:t[`grouped${E(o.orientation)}`]},{[`& .${p.firstButton}`]:t.firstButton},{[`& .${p.lastButton}`]:t.lastButton},{[`& .${p.middleButton}`]:t.middleButton},t.root,o.orientation==="vertical"&&t.vertical,o.fullWidth&&t.fullWidth]}})(Q(({theme:e})=>({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius,variants:[{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${p.grouped}`]:{[`&.${p.selected} + .${p.grouped}.${p.selected}`]:{borderTop:0,marginTop:0}},[`& .${p.firstButton},& .${p.middleButton}`]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`& .${p.lastButton},& .${p.middleButton}`]:{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},[`& .${p.lastButton}.${C.disabled},& .${p.middleButton}.${C.disabled}`]:{borderTop:"1px solid transparent"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"horizontal"},style:{[`& .${p.grouped}`]:{[`&.${p.selected} + .${p.grouped}.${p.selected}`]:{borderLeft:0,marginLeft:0}},[`& .${p.firstButton},& .${p.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${p.lastButton},& .${p.middleButton}`]:{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},[`& .${p.lastButton}.${C.disabled},& .${p.middleButton}.${C.disabled}`]:{borderLeft:"1px solid transparent"}}}]}))),ee=f.forwardRef(function(e,t){const o=q({props:e,name:"MuiToggleButtonGroup"}),{children:r,className:d,color:i="standard",disabled:s=!1,exclusive:l=!1,fullWidth:u=!1,onChange:c,orientation:m="horizontal",size:g="medium",value:h,...T}=o,O={...o,disabled:s,fullWidth:u,orientation:m,size:g},x=xe(O),N=f.useCallback((y,v)=>{if(!c)return;const R=h&&h.indexOf(v);let F;h&&R>=0?(F=h.slice(),F.splice(R,1)):F=h?h.concat(v):[v],c(y,F)},[c,h]),j=f.useCallback((y,v)=>{c&&c(y,h===v?null:v)},[c,h]),w=f.useMemo(()=>({className:x.grouped,onChange:l?j:N,value:h,size:g,fullWidth:u,color:i,disabled:s}),[x.grouped,l,j,N,h,g,u,i,s]),B=me(r),b=B.length,$=y=>{const v=y===0,R=y===b-1;return v&&R?"":v?x.firstButton:R?x.lastButton:x.middleButton};return n.jsx(je,{role:"group",className:K(x.root,d),ref:t,ownerState:O,...T,children:n.jsx(A.Provider,{value:w,children:B.map((y,v)=>(S.env.NODE_ENV!=="production"&&le.isFragment(y)&&console.error(["MUI: The ToggleButtonGroup component doesn't accept a Fragment as a child.","Consider providing an array instead."].join(`
`)),n.jsx(L.Provider,{value:$(v),children:y},v)))})})});S.env.NODE_ENV!=="production"&&(ee.propTypes={children:a.node,classes:a.object,className:a.string,color:a.oneOfType([a.oneOf(["standard","primary","secondary","error","info","success","warning"]),a.string]),disabled:a.bool,exclusive:a.bool,fullWidth:a.bool,onChange:a.func,orientation:a.oneOf(["horizontal","vertical"]),size:a.oneOfType([a.oneOf(["small","medium","large"]),a.string]),sx:a.oneOfType([a.arrayOf(a.oneOfType([a.func,a.object,a.bool])),a.func,a.object]),value:a.any});function $e({value:e,ref:t}){const[o,r]=f.useState(!1);return _(t,e)!==e?n.jsxs("div",{children:[n.jsx("button",{onClick:()=>{r(!o)},children:o?"Show simplified ALT":"Show raw ALT"})," ",o?e:_(t,e)]}):e}function Te({value:e}){const[t,o]=f.useState(!1),[r,d]=f.useState(!1),i=String(e);return i.length>100?n.jsxs(n.Fragment,{children:[n.jsx("button",{type:"button",onClick:()=>{re(i),d(!0),setTimeout(()=>{d(!1)},700)},children:r?"Copied to clipboard":"Copy"}),n.jsx("button",{type:"button",onClick:()=>{o(s=>!s)},children:t?"Show less":"Show more"}),n.jsx("div",{children:t?i:`${i.slice(0,100)}...`})]}):n.jsx("div",{children:i})}function Oe({checked:e,disabled:t,label:o,onChange:r}){return n.jsx(X,{disabled:t,control:n.jsx(Y,{checked:e,onChange:r}),label:n.jsx(G,{variant:"body2",children:o})})}function Be(e){return e.toPrecision(3)}function Ce({rows:e}){const[t,o]=f.useState(!1),r={};if(t)for(const s of e){const l={},u=s.GT.split(/[/|]/);for(const m of u)l[m]=(l[m]||0)+1;const c=Object.entries(l).map(([m,g])=>`${m}:${g}`).join(";");r[c]||(r[c]={count:0,GT:c,genotype:s.genotype}),r[c].count++}else for(const s of e){const l=s.GT;r[l]||(r[l]={count:0,GT:s.GT,genotype:s.genotype}),r[l].count++}const d=Object.entries(r).map(([s,l])=>({id:s,...l,count:`${l.count} / ${e.length}`,frequency:`${Be(l.count/e.length*100)}%`})),i=(d[0]?Object.keys(d[0]):[]).map(s=>M.measureGridWidth(d.map(l=>`${l[s]}`)));return n.jsxs("div",{children:[n.jsx(X,{control:n.jsx(Y,{checked:t}),label:n.jsx(G,{variant:"body2",children:"Use allele counts instead of exact GT"}),onChange:(s,l)=>{o(l)}}),n.jsx(U,{children:n.jsx(Z,{rows:d,hideFooter:!0,rowHeight:25,columnHeaderHeight:35,columns:[{field:"GT",width:i[0]},{field:"count",width:i[1]},{field:"frequency",width:i[2]},{field:"genotype",width:i[3]}]})})]})}function Ne({columns:e,filter:t,setFilter:o}){return n.jsxs(n.Fragment,{children:[n.jsx(G,{children:"These filters can use a plain text search or regex style query, e.g. in the genotype field, entering 1 will query for all genotypes that include the first alternate allele e.g. 0|1 or 1|1, entering [1-9]\\d* will find any non-zero allele e.g. 0|2 or 2/33"}),e.map(({field:r})=>n.jsx(ce,{placeholder:`Filter ${r}`,value:t[r]||"",onChange:d=>{o({...t,[r]:d.target.value})}},`filter-${r}`))]})}function we(e,t,o,r){const d=Object.entries(e).map(([u,c])=>{var m;const g=(m=c.GT)===null||m===void 0?void 0:m[0];return[u,{...c,...g?{GT:`${g}`,genotype:se(`${g}`,t,o)}:{}}]});let i,s=[];const l=Object.keys(r);try{s=d.map(([u,c])=>({...Object.fromEntries(Object.entries(c).map(([m,g])=>[m,g])),sample:u,id:u})).filter(u=>l.length?l.every(c=>{const m=r[c];return m?new RegExp(m,"i").exec(u[c]):!0}):!0)}catch(u){console.error(u),i=u}return{rows:s,error:i}}function Re(e){const{feature:t,descriptions:o={}}=e,[r,d]=f.useState({}),[i,s]=f.useState("all"),[l,u]=f.useState(!1),c=t.samples||{},m=t.ALT,g=t.REF,{rows:h,error:T}=we(c,g,m,r),O=new Set(["sample",...Object.keys(h[0]||{})]);O.delete("id");const x=[...O],N=x.map(b=>M.measureGridWidth(h.map($=>$[b]))),j=x.map((b,$)=>{var y,v;return{field:b,description:(v=(y=o==null?void 0:o.FORMAT)===null||y===void 0?void 0:y[b])===null||v===void 0?void 0:v.Description,width:N[$]}}),w=new Set(["sample","GT"]),B=new Set(["sample","GT","genotype"]);return h.length?n.jsxs(n.Fragment,{children:[n.jsx(W,{...e,title:"Genotype frequencies",children:n.jsx(ae.ErrorBoundary,{FallbackComponent:ie.ErrorMessage,children:n.jsx(Ce,{rows:h})})}),n.jsxs(W,{...e,title:"Samples",children:[T?n.jsx(G,{color:"error",children:`${T}`}):null,n.jsxs("div",{children:[n.jsx(Oe,{label:"Show filters",checked:l,onChange:b=>{u(b.target.checked)}}),n.jsxs(ee,{value:i,exclusive:!0,size:"small",onChange:(b,$)=>{$!==null&&s($)},children:[n.jsx(z,{value:"all",children:"All"}),n.jsx(z,{value:"gtOnly",children:"GT only"}),n.jsx(z,{value:"genotypeOnly",children:"GT+resolved genotype"})]})]}),l?n.jsx(Ne,{setFilter:d,columns:j,filter:r}):null,n.jsx(U,{children:n.jsx(Z,{rows:h,hideFooter:h.length<100,columns:i==="gtOnly"?j.filter(b=>w.has(b.field)):i==="genotypeOnly"?j.filter(b=>B.has(b.field)):j,rowHeight:25,columnHeaderHeight:35,showToolbar:!0})})]})]}):null}const Se={CHROM:"chromosome: An identifier from the reference genome",POS:"position: The reference position, with the 1st base having position 1",ID:"identifier: Semi-colon separated list of unique identifiers where available",REF:"reference base(s): Each base must be one of A,C,G,T,N (case insensitive).",ALT:"alternate base(s): Comma-separated list of alternate non-reference alleles",QUAL:"quality: Phred-scaled quality score for the assertion made in ALT",FILTER:"filter status: PASS if this position has passed all filters, otherwise a semicolon-separated list of codes for filters that fail"},k=f.lazy(()=>D(()=>import("./LaunchBreakendPanel-VPq7sGPh-74QuoJd7.js"),__vite__mapDeps([0,1,2,3,4,5]))),te=f.lazy(()=>D(()=>import("./VariantConsequenceDataGrid-Ba5xSnef-BIeyQ362.js"),__vite__mapDeps([6,1,2,3,4,7,8,9,10,11,12,13,14,15])));function Fe({descriptions:e,feature:t}){var o,r,d,i,s;const l=(r=(o=e==null?void 0:e.INFO)===null||o===void 0?void 0:o.ANN)===null||r===void 0?void 0:r.Description,u=((i=(d=l==null?void 0:l.match(/.*Functional annotations:'(.*)'$/))===null||d===void 0?void 0:d[1])===null||i===void 0?void 0:i.split("|"))||[],c=((s=t.INFO)===null||s===void 0?void 0:s.ANN)||[];return n.jsx(te,{fields:u,data:c,title:"Variant ANN field"})}function ke({descriptions:e,feature:t}){var o,r,d,i,s;const l=(r=(o=e==null?void 0:e.INFO)===null||o===void 0?void 0:o.CSQ)===null||r===void 0?void 0:r.Description,u=((i=(d=l==null?void 0:l.match(/.*Format: (.*)/))===null||d===void 0?void 0:d[1])===null||i===void 0?void 0:i.split("|"))||[],c=((s=t.INFO)===null||s===void 0?void 0:s.CSQ)||[];return n.jsx(te,{fields:u,data:c,title:"Variant CSQ field"})}function ze({model:e}){const{featureData:t}=e,o=JSON.parse(JSON.stringify(t)),{type:r=""}=o;return r==="breakend"?n.jsx(k,{feature:o,locStrings:o.ALT.map(d=>{var i;return((i=ne(d))===null||i===void 0?void 0:i.MatePosition)||""}),model:e}):r==="translocation"?n.jsx(k,{feature:o,model:e,locStrings:[`${o.INFO.CHR2[0]}:${o.INFO.END}`]}):r==="paired_feature"?n.jsx(k,{feature:o,model:e,locStrings:[`${o.mate.refName}:${o.mate.start}`]}):r.includes("inversion")||r.includes("deletion")||r.includes("duplication")||r.includes("cnv")||r.includes("sv")?n.jsx(k,{feature:{uniqueId:"random",refName:o.refName,start:o.start,end:o.start+1,mate:{refName:o.refName,start:o.end,end:o.end+1}},model:e,locStrings:[`${o.refName}:${o.end}`]}):null}const Ge=I(function(e){const{feat:t,model:o}=e,{descriptions:r}=o,{samples:d,...i}=t,{REF:s}=i;return n.jsxs(oe,{"data-testid":"variant-side-drawer",children:[n.jsx(fe,{feature:i,descriptions:{...Se,...r},formatter:(l,u)=>u==="ALT"?n.jsx($e,{value:`${l}`,ref:s}):n.jsx(Te,{value:l}),...e}),n.jsxs(f.Suspense,{fallback:null,children:[n.jsx(ke,{feature:i,descriptions:r}),n.jsx(Fe,{feature:i,descriptions:r}),n.jsx(ze,{model:o})]}),n.jsx(Re,{feature:t,...e,descriptions:r})]})}),Xe=I(function(e){const{model:t}=e,{featureData:o}=t,r=structuredClone(o);return r?n.jsx(Ge,{feat:r,...e}):n.jsx("div",{children:"No feature loaded, may not be available after page refresh because it was too large for localStorage"})});export{Xe as default};
